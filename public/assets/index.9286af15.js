var _e=Object.defineProperty;var te=Object.getOwnPropertySymbols;var be=Object.prototype.hasOwnProperty,fe=Object.prototype.propertyIsEnumerable;var se=(t,e,r)=>e in t?_e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,re=(t,e)=>{for(var r in e||(e={}))be.call(e,r)&&se(t,r,e[r]);if(te)for(var r of te(e))fe.call(e,r)&&se(t,r,e[r]);return t};import{o as i,c as l,n as f,t as k,r as p,a as o,b as m,w as y,d as M,F as v,e as C,f as S,g as D,C as H,D as W,h as N,i as $,j as h,k as z,T as le,l as T,v as O,m as J,p as R,q as Z,s as ye,U as ve,u as Ce,x as de,y as Te,z as Se,A as Ee,B as Me,E as Be,G as we,H as $e}from"./vendor.caf0b19e.js";const Oe=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))d(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const n of s.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&d(n)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerpolicy&&(s.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?s.credentials="include":a.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function d(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}};Oe();const x={delay:xe,getRndIntInc:De,makeId:Ae,getRandomColor:Le,applyDrag:Ie,saveToStorage:Ue,loadFromStorage:Ne,lightenDarkenColor:Ge,debounce:Je};function xe(t=1500){return new Promise(e=>{setTimeout(e,t)})}function De(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1)+t)}function Ie(t,e){console.log("arr>>",t,"drag",e);const{removedIndex:r,addedIndex:d,payload:a}=e;if(r===null&&d===null)return t;const s=[...t];let n=a;return r!==null&&(n=s.splice(r,1)[0]),d!==null&&s.splice(d,0,n),console.log(s),s}function Ae(t=8){for(var e="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",d=0;d<t;d++)e+=r.charAt(Math.floor(Math.random()*r.length));return e}function Le(){for(var t="0123456789ABCDEF",e="#",r=0;r<6;r++)e+=t[Math.floor(Math.random()*16)];return e}function Ue(t,e){localStorage.setItem(t,JSON.stringify(e)||null)}function Ne(t){let e=localStorage.getItem(t);return e?JSON.parse(e):void 0}function Ge(t,e){if(t==="#0079bf")return"#055a8c";if(t==="#00c2e0")return"#0098b7";var r=!1;t[0]=="#"&&(t=t.slice(1),r=!0);var d=parseInt(t,16),a=(d>>16)+e;a>255?a=255:a<0&&(a=0);var s=(d>>8&255)+e;s>255?s=255:s<0&&(s=0);var n=(d&255)+e;return n>255?n=255:n<0&&(n=0),(r?"#":"")+(n|s<<8|a<<16).toString(16)}function Je(t,e){let r;return(...d)=>{clearTimeout(r),r=setTimeout(()=>{t(...d)},e)}}var _=(t,e)=>{const r=t.__vccOpts||t;for(const[d,a]of e)r[d]=a;return r};const je={name:"user-avatar",props:{user:Object,diameter:{type:Number,default:28}},methods:{getNameAbbreviation(t){return console.error("fullName",t),t?t.split(" ").map(d=>d.charAt(0).toUpperCase()).join(""):"\u2753"}},computed:{userColor(){return`background-color: ${this.user.color||x.getRandomColor()}`},getSizeInCss(){return{width:this.diameter+"px",height:this.diameter+"px","line-height":this.diameter+"px"}}}},ze=["src"];function Fe(t,e,r,d,a,s){return i(),l("div",{class:"user-avatar",style:f(s.getSizeInCss)},[r.user.imgUrl?(i(),l("img",{key:0,src:r.user.imgUrl},null,8,ze)):(i(),l("div",{key:1,class:"flex center",style:f(s.userColor)},k(s.getNameAbbreviation(r.user.fullname)),5))],4)}var G=_(je,[["render",Fe]]),qe="/assets/homeLogo.10aa9f3f.png",Pe="/assets/Asset3.171b9aa8.png";const Ve={name:"home",components:{},created(){},methods:{async goToBoardsPage(){this.$router.push("/board/624afa5e47cdb81018c1bc99")},async startGuest(){await E.guest(),this.$router.push("/board/6297c0b99389cf297839f68a")}}},Re={class:"homepage"},He={class:"homepage-nav flex"},We=o("img",{src:qe,alt:""},null,-1),Ze=M("Log in"),Ye=M("Sign up"),Ke={class:"flex center"},Xe=o("img",{class:"hero",src:Pe,alt:""},null,-1),Qe={class:"text"},et=o("h1",null,"Mello helps teams move work forward.",-1),tt=o("p",null,"As your software team grows, Mello makes it easy to manage workflows across multiple teams and projects. Simple, intuitive, fast: Mello is where software teams do their best work. Free to get started, with easy user experience Mello.",-1);function st(t,e,r,d,a,s){const n=p("router-link");return i(),l("section",Re,[o("nav",He,[m(n,{title:"Boards",to:"/board",class:"logo"},{default:y(()=>[We]),_:1}),o("div",null,[m(n,{title:"Login",to:"/login",class:"login"},{default:y(()=>[Ze]),_:1}),m(n,{title:"Signup",to:"/signup",class:"signup"},{default:y(()=>[Ye]),_:1})])]),o("main",Ke,[Xe,o("div",Qe,[et,tt,o("a",{onClick:e[0]||(e[0]=(...c)=>s.startGuest&&s.startGuest(...c)),class:"btn-start"},"Start as a guest")])])])}var rt=_(Ve,[["render",st]]);const ot={data(){return{}},async mounted(){await this.$store.dispatch({type:"loadBoards"}),console.log(this.boards)},computed:{boards(){return this.$store.getters.boards},starBoards(){return this.$store.getters.starBoards}},methods:{checkStar(t){if(t.star)return"star-on"},async starBoard(t){const e=this.$store.getters.boards,r=e.findIndex(d=>d._id===t);e[r].star?e[r].star=!1:e[r].star=!0,await this.$store.dispatch({type:"saveCurrBoard",boardToSave:e[r]}),await this.$store.dispatch({type:"loadBoards"})}}},at={class:"board-list flex center column align-center"},nt=o("h3",null,"STARRED BOARDS",-1),it={class:"board-list-container flex wrap center"},lt=["onClick"],dt={class:"board-title"},ct=["onClick"],ut=["src"],ht=o("h3",{class:"boards"},"YOUR BOARDS",-1),mt={class:"board-list-container flex wrap center"},pt=["onClick"],gt={class:"board-title"},kt=["onClick"],_t=["src"];function bt(t,e,r,d,a,s){return i(),l("section",at,[o("section",null,[nt,o("div",it,[(i(!0),l(v,null,C(s.starBoards,n=>(i(),l("label",{onClick:c=>t.$router.push(`/board/${n._id}`),key:n._id},[o("span",dt,k(n.title),1),o("span",{onClick:S(c=>s.starBoard(n._id),["stop"]),class:D([s.checkStar(n),"board-star"])},null,10,ct),n.style.bg.split("")[0]!=="#"?(i(),l("img",{key:0,src:n.style.bg,alt:""},null,8,ut)):(i(),l("div",{key:1,style:f({"background-color":`${n.style.bg}`})},null,4))],8,lt))),128))])]),o("section",null,[ht,o("div",mt,[(i(!0),l(v,null,C(s.boards,n=>(i(),l("label",{onClick:c=>t.$router.push(`/board/${n._id}`),key:n._id},[o("span",gt,k(n.title),1),o("span",{onClick:S(c=>s.starBoard(n._id),["stop"]),class:D([s.checkStar(n),"board-star"])},null,10,kt),n.style.bg.split("")[0]!=="#"?(i(),l("img",{key:0,src:n.style.bg,alt:""},null,8,_t)):(i(),l("div",{key:1,style:f({"background-color":`${n.style.bg}`})},null,4))],8,pt))),128))])])])}var ft=_(ot,[["render",bt]]);const yt={name:"task-preview",props:{task:Object,labelsOpen:Boolean},components:{userAvatar:G,Container:H,Draggable:W},data(){return{hover:!1,open:!0,dateBg:"",dateClass:"clock"}},mounted(){this.loadDate()},methods:{async updateTask(){const t=JSON.parse(JSON.stringify(this.task));this.$emit("saveTask",t),this.$emit("socketUpdateBoard")},removeTask(){this.$emit("removeTask",this.task),this.$emit("socketUpdateBoard")},toggleDateBg(t){this.dateBg=x.lightenDarkenColor(this.dateBg,t)},getStyle(t){const r=this.$store.getters.currBoardLabels.find(d=>d.id===t);if(!!r)return this.hover?`background-color: ${x.lightenDarkenColor(r==null?void 0:r.color,-30)}`:`background-color: ${r==null?void 0:r.color}`},getLabelText(t){const r=this.$store.getters.currBoardLabels.find(d=>d.id===t);if(!!r)return`${r.title}`},toggleLabels(){this.$emit("openLabels"),this.open=!this.open},toggleDate(){if(this.task.status==="over-due"||this.task.status==="in-progress"||this.task.status==="due-soon"){this.$emit("done"),this.updateTask();return}if(this.task.dueDate-Date.now()<0){this.$emit("over-due"),this.updateTask();return}if(this.task.dueDate-Date.now()>86400*1e3){this.$emit("in-progress"),this.updateTask();return}if(this.task.dueDate-Date.now()<86400*1e3){this.$emit("due-soon"),this.updateTask();return}},loadDate(){if(this.task.status!=="done"){if(this.task.dueDate-Date.now()<0){this.task.status="over-due";return}if(this.task.dueDate-Date.now()>86400*1e3){this.task.status="in-progress";return}if(this.task.dueDate-Date.now()<86400*1e3){this.task.status="due-soon";return}}},socketUpdateBoard(){this.$emit("socketUpdateBoard")}},computed:{checkComplete(){var t=!0;if(this.task.checklists.forEach(e=>{e.todos.forEach(r=>{r.isDone||(t=!1)})}),t)return"complete"},checklistComplete(){var t=0;return this.task.checklists.forEach(e=>{e.todos.forEach(r=>{r.isDone&&t++})}),t},checklistTotal(){var t=0;return this.task.checklists.forEach(e=>{t+=e.todos.length}),t},checkStyle(){if(this.task.style&&this.task.style.size==="big")return"border-bottom: none"},getCoverClr(){return`background-color: ${this.task.style.bg} !important`},checkBadges(){return!(!this.task.members&&!this.task.startDate&&!this.task.dueDate)},getClass(){return this.labelsOpen?"open":"close"},getDateClass(){return this.task.status},startDate(){return N(this.task.startDate,"MMM d")},dueDate(){return N(this.task.dueDate,"MMM d")},getWidth(){var t=0;if((this.task.startDate||this.task.dueDate)&&t++,this.task.comments&&t++,this.task.checklists&&t++,this.task.attachments&&t++,t>2)return"margin-block-start: 30px; position: absolute; right: 0;"},getHeight(){var t=0;if((this.task.startDate||this.task.dueDate)&&t++,this.task.comments&&t++,this.task.checklists&&t++,this.task.attachments&&t++,t>2&&this.task.members&&this.task.members.length)return"margin-block-end: 37px"},getDateBg(){this.task.startDate&&this.task.dueDate}},watch:{task(t,e){this.loadDate()}}},vt={class:"task-preview"},Ct={key:0,class:"small-cover"},Tt=["src"],St={key:1,class:"big-cover"},Et={class:"img-txt"},Mt=o("div",null,null,-1),Bt={key:2},wt={key:0,class:"task-labels"},$t={key:1,class:"task-preview-badges flex sapce-between"},Ot={key:0,class:"task-preview-date"},xt={key:0,class:"start-only"},Dt=o("span",null,null,-1),It=o("span",null,"-",-1),At={key:1,class:"task-preview-comments"},Lt=o("span",null,null,-1),Ut={key:2,class:"task-preview-attachments"},Nt=o("span",null,null,-1),Gt={key:0,class:""},Jt=o("span",null,null,-1),jt=o("span",null,"/",-1);function zt(t,e,r,d,a,s){const n=p("user-avatar"),c=p("Draggable");return i(),$(c,null,{default:y(()=>[o("section",vt,[o("button",{onClick:e[0]||(e[0]=S((...u)=>s.removeTask&&s.removeTask(...u),["stop"])),title:"Remove card",class:"btn-remove-task"}),r.task.style&&r.task.style.size==="small"?(i(),l("section",Ct,[r.task.style&&r.task.style.bg.split("")[0]!=="#"?(i(),l("img",{key:0,src:r.task.style.bg,alt:""},null,8,Tt)):(i(),l("div",{key:1,style:f(s.getCoverClr),class:"cover-clr"},null,4))])):h("",!0),r.task.style&&r.task.style.size==="big"?(i(),l("section",St,[r.task.style&&r.task.style.bg.split("")[0]!=="#"?(i(),l("div",{key:0,class:"big-cover-img",style:f({"background-image":`url(${r.task.style.bg})`})},[o("div",Et,[Mt,o("div",null,[o("span",null,k(r.task.title),1)])])],4)):h("",!0),r.task.style&&r.task.style.bg.split("")[0]==="#"?(i(),l("div",{key:1,class:"big-cover-clr",style:f({"background-color":`${r.task.style.bg}`})},[o("div",null,[o("span",null,k(r.task.title),1)])],4)):h("",!0)])):h("",!0),!r.task.style||r.task.style.size==="small"?(i(),l("section",Bt,[r.task.labelIds?(i(),l("section",wt,[(i(!0),l(v,null,C(r.task.labelIds,u=>(i(),l("span",{onClick:e[1]||(e[1]=S((...b)=>s.toggleLabels&&s.toggleLabels(...b),["stop"])),onMouseover:e[2]||(e[2]=b=>a.hover=!0),onMouseleave:e[3]||(e[3]=b=>a.hover=!1),key:u,class:D(["task-preview-label",s.getClass]),style:f(s.getStyle(u))},[o("span",null,k(s.getLabelText(u)),1)],38))),128))])):h("",!0),o("p",null,k(r.task.title),1),s.checkBadges?(i(),l("section",$t,[o("section",{style:f(s.getHeight),class:"flex"},[r.task.startDate||r.task.dueDate?(i(),l("section",Ot,[r.task.startDate&&!r.task.dueDate?(i(),l("div",xt,[Dt,o("span",null,"Starts: "+k(s.startDate),1)])):h("",!0),!r.task.startDate&&r.task.dueDate?(i(),l("div",{key:1,class:D([s.getDateClass,"due-only"]),onClick:e[4]||(e[4]=S((...u)=>s.toggleDate&&s.toggleDate(...u),["stop"])),onMouseover:e[5]||(e[5]=u=>{s.toggleDateBg(-30),a.dateClass="unCheck"}),onMouseleave:e[6]||(e[6]=u=>{s.toggleDateBg(30),a.dateClass="clock"}),style:f(s.getDateBg)},[o("span",{class:D(a.dateClass)},null,2),o("span",null,k(s.dueDate),1)],38)):h("",!0),r.task.startDate&&r.task.dueDate?(i(),l("div",{key:2,class:D([s.getDateClass,"due-only"]),onClick:e[7]||(e[7]=S((...u)=>s.toggleDate&&s.toggleDate(...u),["stop"])),onMouseover:e[8]||(e[8]=u=>{s.toggleDateBg(-30),a.dateClass="unCheck"}),onMouseleave:e[9]||(e[9]=u=>{s.toggleDateBg(30),a.dateClass="clock"}),style:f(s.getDateBg)},[o("span",{class:D(a.dateClass)},null,2),o("span",null,k(s.startDate),1),It,o("span",null,k(s.dueDate),1)],38)):h("",!0)])):h("",!0),r.task.comments?(i(),l("section",At,[Lt,o("span",null,k(r.task.comments.length),1)])):h("",!0),r.task.attachments?(i(),l("section",Ut,[Nt,o("span",null,k(r.task.attachments.length),1)])):h("",!0),r.task.checklists?(i(),l("section",{key:3,class:D([s.checkComplete,"task-preview-checklists"])},[r.task.checklists.length?(i(),l("section",Gt,[Jt,o("span",null,k(s.checklistComplete),1),jt,o("span",null,k(s.checklistTotal),1)])):h("",!0)],2)):h("",!0)],4),o("section",null,[r.task.members?(i(),l("section",{key:0,style:f(s.getWidth),class:"flex task-members"},[(i(!0),l(v,null,C(r.task.members,u=>(i(),$(n,{key:u._id,user:u},null,8,["user"]))),128))],4)):h("",!0)])])):h("",!0)])):h("",!0)])]),_:1})}var ce=_(yt,[["render",zt]]);const Ft={props:{menuOpen:Boolean},data(){return{}},methods:{}},qt={class:"custom-menu"},Pt={key:0,class:"custom-menu-container"};function Vt(t,e,r,d,a,s){return i(),l("section",qt,[m(le,{"enter-active-class":"animate__animated animate__fadeIn animate__faster","leave-active-class":"animate__animated animate__fadeOut animate__faster"},{default:y(()=>[r.menuOpen?(i(),l("div",Pt,[z(t.$slots,"default")])):h("",!0)]),_:3})])}var q=_(Ft,[["render",Vt]]);const Rt={props:{menuOpen:Boolean},data(){return{}},components:{customMenu:q},methods:{addTask(){this.$emit("newTask")},copyGroup(){this.$emit("copyGroup")},removeGroup(){this.$emit("removeGroup")},closeMenu(){this.$emit("closeMenu")}}},Ht={class:"group-menu"},Wt=o("p",null,"List actions",-1),Zt=o("hr",null,null,-1),Yt=o("hr",null,null,-1);function Kt(t,e,r,d,a,s){const n=p("custom-menu");return i(),l("section",Ht,[m(n,{menuOpen:r.menuOpen},{default:y(()=>[Wt,o("button",{onClick:e[0]||(e[0]=(...c)=>s.closeMenu&&s.closeMenu(...c)),class:"close",title:"Close"}),Zt,o("p",{onClick:e[1]||(e[1]=(...c)=>s.addTask&&s.addTask(...c))},"Add card..."),o("p",{onClick:e[2]||(e[2]=(...c)=>s.copyGroup&&s.copyGroup(...c))},"Copy list..."),Yt,o("p",{onClick:e[3]||(e[3]=(...c)=>s.removeGroup&&s.removeGroup(...c))},"Remove this list...")]),_:1},8,["menuOpen"])])}var Xt=_(Rt,[["render",Kt]]);const Qt={props:{menuOpen:Boolean,groupTitle:String},data(){return{titleForDisplay:JSON.parse(JSON.stringify(this.groupTitle))}},components:{customMenu:q},mounted(){},methods:{addTask(){this.$emit("newTask")},saveGroup(){this.$emit("saveGroup",this.titleForDisplay)},closeMenu(){this.$emit("closeMenu")}}},es={class:"copy-group-menu"},ts=o("p",null,"Copy list",-1),ss=o("hr",null,null,-1),rs=o("div",null,"Name",-1),os=o("button",null,"Create list",-1);function as(t,e,r,d,a,s){const n=p("custom-menu");return i(),l("section",es,[m(n,{menuOpen:r.menuOpen},{default:y(()=>[ts,o("button",{onClick:e[0]||(e[0]=(...c)=>s.closeMenu&&s.closeMenu(...c)),class:"close",title:"Close"}),ss,o("form",{action:"submit",onSubmit:e[2]||(e[2]=S((...c)=>s.saveGroup&&s.saveGroup(...c),["prevent"]))},[rs,T(o("textarea",{style:{resize:"none"},"onUpdate:modelValue":e[1]||(e[1]=c=>a.titleForDisplay=c)},null,512),[[O,a.titleForDisplay]]),os],32)]),_:1},8,["menuOpen"])])}var ns=_(Qt,[["render",as]]);const is={name:"task-add",props:{task:Object},data(){return{isSave:!0}},methods:{saveTask(){this.isSave||(this.task.title=""),console.log(this.task),this.$emit("saveTask",this.task)},func(){console.log("hover")}},mounted(){this.$refs.taskTitle.focus()}},ls={class:"task-add"},ds=o("button",{type:"submit"},"Add card",-1);function cs(t,e,r,d,a,s){return i(),l("section",ls,[o("form",{action:"submit",onSubmit:e[3]||(e[3]=S((...n)=>s.saveTask&&s.saveTask(...n),["prevent","stop"]))},[T(o("textarea",{ref:"taskTitle",style:{resize:"none",width:"256px",height:"66px"},placeholder:"Enter a title for this card...","onUpdate:modelValue":e[0]||(e[0]=n=>r.task.title=n)},null,512),[[O,r.task.title]]),o("div",null,[ds,o("button",{onMouseover:e[1]||(e[1]=n=>a.isSave=!1),onMouseleave:e[2]||(e[2]=n=>a.isSave=!0),title:"Close"},null,32)])],32)])}var oe=_(is,[["render",cs]]);const us={props:{group:{type:Object,required:!0}},data(){return{taskToEdit:null,menuOpen:!1,subMenuOpen:!1,subTaskToEdit:null}},components:{taskPreview:ce,groupMenu:Xt,taskAdd:oe,copyGroupMenu:ns,Container:H,Draggable:W,TaskAdd:oe},methods:{async delay(){setTimeout(()=>{},9e3)},closeMenu(){this.menuOpen=!1,this.subMenuOpen=!1},toggleMenu(){this.menuOpen=!this.menuOpen,this.subMenuOpen&&(this.subMenuOpen=!this.subMenuOpen,this.menuOpen=!1)},updateGroup(){this.$emit("updateGroup",this.group)},addTask(t){this[t]=I.getEmptyTask(),this.menuOpen=!1},saveTask(t){t.title&&(this.group.tasks.push(t),this.updateGroup()),this.taskToEdit=null,this.subTaskToEdit=null},saveGroup(t){const e=JSON.parse(JSON.stringify(this.group));e.title=t,e.id="",e.tasks.forEach(r=>{r.id=x.makeId()}),this.menuOpen=!1,this.subMenuOpen=!1,this.$emit("saveGroup",e)},getCardPayload(t){return e=>this.board.groups.filter(r=>r.id===t)[0].tasks[e]},onCardDrop(t,e){if(console.log(e),e.removedIndex!==null||e.addedIndex!==null){const r=Object.assign({},this.board),d=r.groups.filter(n=>n.id===t)[0],a=r.groups.indexOf(d),s=Object.assign({},d);e.removedIndex==null&&e.addedIndex>=0,s.tasks=x.applyDrag(s.tasks,e),r.groups.splice(a,1,s),this.$emit("move",r)}}},computed:{}},hs={class:"board-group"},ms={class:"group-header"},ps={class:"tasks-container"},gs=o("span",null,null,-1),ks=o("span",null,"Add a card",-1),_s=[gs,ks],bs={class:"sub-task-add"};function fs(t,e,r,d,a,s){const n=p("group-menu"),c=p("copy-group-menu"),u=p("task-add");return i(),l("section",hs,[o("div",ms,[T(o("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=b=>r.group.title=b),class:"group-title",onBlur:e[1]||(e[1]=(...b)=>s.updateGroup&&s.updateGroup(...b))},null,544),[[O,r.group.title]]),o("button",{onClick:e[2]||(e[2]=(...b)=>s.toggleMenu&&s.toggleMenu(...b)),class:"btn-group-menu",title:"Menu"}),m(n,{onRemoveGroup:e[3]||(e[3]=b=>t.$emit("removeGroup",r.group)),onCopyGroup:e[4]||(e[4]=b=>{a.menuOpen=!1,a.subMenuOpen=!0}),onCloseMenu:e[5]||(e[5]=b=>a.menuOpen=!1),onNewTask:e[6]||(e[6]=b=>s.addTask("taskToEdit")),menuOpen:a.menuOpen},null,8,["menuOpen"]),m(c,{onSaveGroup:s.saveGroup,onCloseMenu:e[7]||(e[7]=b=>a.subMenuOpen=!1),menuOpen:a.subMenuOpen,groupTitle:r.group.title},null,8,["onSaveGroup","menuOpen","groupTitle"])]),a.taskToEdit?(i(),$(u,{key:0,task:a.taskToEdit,onSaveTask:s.saveTask},null,8,["task","onSaveTask"])):h("",!0),o("div",ps,[z(t.$slots,"default")]),a.subTaskToEdit?h("",!0):(i(),l("div",{key:1,onClick:e[8]||(e[8]=b=>s.addTask("subTaskToEdit")),class:"flex align-center btn-task-add"},_s)),o("div",bs,[a.subTaskToEdit?(i(),$(u,{key:0,task:a.subTaskToEdit,onSaveTask:s.saveTask},null,8,["task","onSaveTask"])):h("",!0)])])}var ys=_(us,[["render",fs]]);const vs={props:{isAddingGroup:Boolean},data(){return{groupToAdd:I.getEmptyGroup()}},methods:{addGroup(){this.$emit("addGroup"),this.$nextTick(()=>{this.$refs.title.focus()})},saveGroup(){this.groupToAdd.title=this.groupToAdd.title.trim(),console.log("group>>",this.groupToAdd),this.groupToAdd.title&&(this.$emit("saveGroup",this.groupToAdd),this.groupToAdd=I.getEmptyGroup())},closeGroupAdd(){this.groupToAdd=I.getEmptyGroup(),this.$emit("closeGroupAdd")}}},Cs=o("div",{class:"flex align-center"},[o("span"),o("span",null,"Add another list")],-1),Ts=[Cs],Ss={key:1,class:"group-edit"},Es=o("button",null,"Add list",-1);function Ms(t,e,r,d,a,s){return i(),l("section",null,[r.isAddingGroup?(i(),l("div",{key:0,onClick:e[0]||(e[0]=(...n)=>s.addGroup&&s.addGroup(...n)),class:"group-add"},Ts)):h("",!0),r.isAddingGroup?h("",!0):(i(),l("div",Ss,[o("form",{type:"submit",onSubmit:e[3]||(e[3]=S((...n)=>s.saveGroup&&s.saveGroup(...n),["prevent"]))},[T(o("input",{type:"text",ref:"title",placeholder:"Enter list title...","onUpdate:modelValue":e[1]||(e[1]=n=>a.groupToAdd.title=n)},null,512),[[O,a.groupToAdd.title]]),o("div",null,[Es,o("button",{onClick:e[2]||(e[2]=(...n)=>s.closeGroupAdd&&s.closeGroupAdd(...n))})])],32)]))])}var Bs=_(vs,[["render",Ms]]);const ws={props:{menuOpen:Boolean},data(){return{users:null,members:null,board:null,updateKey:0}},components:{customMenu:q,userAvatar:G},async created(){this.users=await E.getUsers();const t=E.getLoggedinUser();this.users=this.users.filter(e=>e._id!==t._id),console.log(this.$route.params.boardId),this.board=await I.getById(this.$route.params.boardId),this.members=this.board.members},mounted(){console.log(this.$store.getters.currBoard)},methods:{checkMember(t){return this.members.findIndex(e=>e._id==t)!==-1},async shareBoard(t){if(this.board=await I.getById(this.$route.params.boardId),this.members=this.board.members,this.members.findIndex(r=>r._id===t)!==-1){console.log("hi");return}this.$emit("shareBoard",t),this.updateKey+=1},closeMenu(){this.$emit("closeMenu")},async saveBoard(){}},computed:{},watch:{async"$route.params.boardId"(t){console.log("Changed to",this.board),console.log(this.$store.getters.currBoard),this.board=await I.getById(this.$route.params.boardId),this.members=this.board.members}}},$s={class:"board-share-menu"},Os=o("p",null,"Share",-1),xs=o("hr",null,null,-1),Ds={class:"users"},Is=["onClick"],As={class:"name"},Ls={key:0,class:"member-mark"};function Us(t,e,r,d,a,s){const n=p("user-avatar"),c=p("custom-menu");return i(),l("section",$s,[m(c,{menuOpen:r.menuOpen},{default:y(()=>[Os,o("button",{onClick:e[0]||(e[0]=(...u)=>s.closeMenu&&s.closeMenu(...u)),class:"close",title:"Close"}),xs,o("section",Ds,[(i(!0),l(v,null,C(a.users,u=>(i(),l("div",{onClick:b=>s.shareBoard(u._id),class:"user flex align-center",key:u._id},[m(n,{user:u},null,8,["user"]),o("div",As,k(u.fullname),1),s.checkMember(u._id)?(i(),l("span",Ls)):h("",!0)],8,Is))),128))])]),_:1},8,["menuOpen"])])}var Ns=_(ws,[["render",Us]]);const Gs={props:{board:{type:Object,required:!0}},components:{userAvatar:G,boardShareMenu:Ns},data(){return{boardTitleToEdit:null,isMembersMenuOpen:!1,isSideMenuOpen:!1,boardMenuOpen:!1}},computed:{selected(){return{selected:this.board.isStarred}},users(){return this.$store.getters.users},boardTitle(){return JSON.parse(JSON.stringify(this.board.title))},userWorkspace(){const t=this.board.createdBy.fullname.split(" ");return console.log(t),t[0]+" "+t[1].split("")[0]+"'s"},checkStar(){if(this.board.star)return"star-on"}},created(){},watch:{boardTitle:{immediate:!0,handler(){this.boardTitleToEdit=this.boardTitle}}},methods:{setBackground(t){this.$emit("setBackground",t)},starBoard(){this.board.star?this.$emit("starBoard",!1):this.$emit("starBoard",!0)},shareBoard(t){this.$emit("shareBoard",t)}}},Js={class:"board-header"},js={class:"flex"},zs={class:"board-title",contenteditable:"true"},Fs=o("div",null,null,-1),qs=[Fs],Ps=M(),Vs=o("span",{class:"nav-divider"},"|",-1),Rs={class:"btn-user-space"},Hs=M(),Ws=o("span",{class:"nav-divider sub"},"|",-1),Zs={class:"flex board-members"},Ys=o("span",null,null,-1),Ks=M("Share"),Xs=[Ys,Ks];function Qs(t,e,r,d,a,s){const n=p("user-avatar"),c=p("board-share-menu");return i(),l("div",Js,[o("div",js,[o("h2",zs,k(r.board.title),1),o("button",{onClick:e[0]||(e[0]=(...u)=>s.starBoard&&s.starBoard(...u)),class:D([s.checkStar,"btn-star-board"])},qs,2),Ps,Vs,o("button",Rs,[o("h4",null,k(s.userWorkspace)+" Workspace",1)]),Hs,Ws,o("div",Zs,[(i(!0),l(v,null,C(r.board.members,u=>(i(),$(n,{key:u._id,user:u},null,8,["user"]))),128)),o("button",{onClick:e[1]||(e[1]=u=>a.boardMenuOpen=!a.boardMenuOpen),class:"btn-share-board flex center align-center"},Xs),m(c,{onShareBoard:s.shareBoard,onCloseMenu:e[2]||(e[2]=u=>a.boardMenuOpen=!1),menuOpen:a.boardMenuOpen},null,8,["onShareBoard","menuOpen"])])])])}var er=_(Gs,[["render",Qs]]);const tr={name:"board-details",data(){return{isAddingGroup:!0,labelsOpen:!1,loadDate:!1}},components:{boardGroup:ys,groupAdd:Bs,Container:H,Draggable:W,boardHeader:er,taskPreview:ce},async mounted(){const{boardId:t}=this.$route.params;await this.$store.dispatch({type:"loadCurrBoard",boardId:t}),this.board.style&&(document.body.style=`
   background-image: url(${this.board.style.bg});
   background-color: ${this.board.style.bg};`,console.log(this.board))},unmounted(){document.body.style=`
   background: none;`},computed:{board(){return this.$store.getters.currBoard},unfilteredBoard(){return this.$store.state.boardStore.currBoard}},methods:{async starBoard(t){const e=this.$store.getters.currBoard;e.star=t,await this.$store.dispatch({type:"saveCurrBoard",boardToSave:e})},async shareBoard(t){const e=this.$store.getters.currBoard,r=await E.getMiniUser(t);e.members.unshift(r),await this.$store.dispatch({type:"saveCurrBoard",boardToSave:e})},async saveTask(t,e){await this.$store.dispatch({type:"saveTask",groupId:e,taskToSave:t})},async removeGroup(t){await this.$store.dispatch({type:"removeGroup",group:t})},async removeTask(t,e){await this.$store.dispatch({type:"removeTask",groupId:e.id,taskId:t.id})},async updateGroup(t){this.isAddingGroup||(this.isAddingGroup=!0),t.title&&await this.$store.dispatch({type:"updateGroup",groupToSave:t})},async loadBoard(){const{boardId:t}=this.$route.params,e=await this.$store.dispatch({type:"loadCurrBoard",boardId:t});return this.board=e,this.board.style&&(document.body.style=`
    background-image: url(${this.board.style.bg});
    background-color: ${this.board.style.bg};`),e},async onColumnDrop(t){const e=Object.assign({},this.board);console.log(e),t.payload={},t.payload.data=this.board.groups[t.removedIndex],t.payload.id=this.board.groups[t.removedIndex].id,console.log("drop>>",t),e.groups=x.applyDrag(e.groups,t),await this.$store.dispatch({type:"saveCurrBoard",boardToSave:e})},getCardPayload(t){return e=>this.board.groups.filter(r=>r.id===t)[0].tasks[e]},async onCardDrop(t,e){if(console.log(e),e.removedIndex!==null||e.addedIndex!==null){const r=Object.assign({},this.board),d=r.groups.filter(n=>n.id===t)[0],a=r.groups.indexOf(d),s=Object.assign({},d);e.removedIndex==null&&e.addedIndex>=0,s.tasks=x.applyDrag(s.tasks,e),r.groups.splice(a,1,s),await this.$store.dispatch({type:"saveCurrBoard",boardToSave:r})}},goToDetail(t,e){this.$router.push(`/board/${this.board._id}/task/${t.id}/${e.id}`)}},watch:{"$route.params.boardId"(t){!t||(console.log("Changed to",t),this.loadBoard())}}},sr={key:0,class:"board-details"},rr=o("div",{class:"bg"},null,-1),or={class:"group-list flex"};function ar(t,e,r,d,a,s){const n=p("board-header"),c=p("router-view"),u=p("task-preview"),b=p("Container"),A=p("board-group"),P=p("Draggable"),V=p("group-add");return s.board?(i(),l("section",sr,[rr,m(n,{onShareBoard:s.shareBoard,onStarBoard:s.starBoard,board:s.board},null,8,["onShareBoard","onStarBoard","board"]),m(c),o("div",or,[m(b,{"drop-placeholder":{className:"col-drop",animationDuration:"100",showOnTop:!1},"drag-class":"col-drag","group-name":"cols",tag:"div",orientation:"horizontal",onDrop:e[1]||(e[1]=B=>s.onColumnDrop(B)),onTouchend:e[2]||(e[2]=B=>s.onColumnDrop(B))},{default:y(()=>[(i(!0),l(v,null,C(s.board.groups,B=>(i(),$(P,{key:B.id},{default:y(()=>[o("div",null,[m(A,{group:B,onUpdateGroup:s.updateGroup,onSaveGroup:s.updateGroup,onRemoveGroup:s.removeGroup},{default:y(()=>[m(b,{orientation:"vertical","group-name":"col-items",shouldAcceptDrop:(w,g)=>w.groupName==="col-items","get-child-payload":s.getCardPayload(B.id),"drop-placeholder":{className:"item-drop",animationDuration:"200",showOnTop:!0},"drag-class":"item-drag",onDrop:w=>s.onCardDrop(B.id,w),onTouchend:w=>s.onCardDrop(B.id,w)},{default:y(()=>[(i(!0),l(v,null,C(B.tasks,w=>(i(),$(u,{onDueSoon:g=>w.status="due-soon",onInProgress:g=>w.status="in-progress",onOverDue:g=>w.status="over-due",onDone:g=>w.status="done",onSaveTask:g=>s.saveTask(w,B.id),onOpenLabels:e[0]||(e[0]=g=>a.labelsOpen=!a.labelsOpen),labelsOpen:a.labelsOpen,onClick:g=>s.goToDetail(B,w),key:w.id,task:w,onRemoveTask:g=>s.removeTask(w,B)},null,8,["onDueSoon","onInProgress","onOverDue","onDone","onSaveTask","labelsOpen","onClick","task","onRemoveTask"]))),128))]),_:2},1032,["shouldAcceptDrop","get-child-payload","onDrop","onTouchend"])]),_:2},1032,["group","onUpdateGroup","onSaveGroup","onRemoveGroup"])])]),_:2},1024))),128))]),_:1}),m(V,{onAddGroup:e[3]||(e[3]=B=>a.isAddingGroup=!1),onSaveGroup:s.updateGroup,onCloseGroupAdd:e[4]||(e[4]=B=>a.isAddingGroup=!0),isAddingGroup:a.isAddingGroup},null,8,["onSaveGroup","isAddingGroup"])])])):h("",!0)}var nr=_(tr,[["render",ar]]);const ir={name:"trello-labels",props:{labels:Array},methods:{openEditModal(t){this.$emit("editModalOpened",t,"labelsEdit")}}},lr={class:"trello-labels"},dr=o("span",{class:"secondary-section-title"},"Labels",-1),cr={class:"clean-list flex wrap"};function ur(t,e,r,d,a,s){return i(),l("section",lr,[dr,o("ul",cr,[(i(!0),l(v,null,C(r.labels,n=>(i(),l("li",{key:n.id},[o("div",{class:"label",style:f({"background-color":n.color}),onClick:e[0]||(e[0]=(...c)=>s.openEditModal&&s.openEditModal(...c))},k(n.title),5)]))),128)),o("li",null,[o("button",{class:"add-label btn-default",onClick:e[1]||(e[1]=(...n)=>s.openEditModal&&s.openEditModal(...n))})])])])}var hr=_(ir,[["render",ur]]);const mr={name:"trello-members",props:{members:Array},methods:{openEditModal(t){console.log("event",t),this.$emit("editModalOpened",t,"membersEdit")}},components:{userAvatar:G}},pr={class:"trello-members"},gr=o("span",{class:"secondary-section-title"},"Members",-1),kr={class:"clean-list"};function _r(t,e,r,d,a,s){const n=p("user-avatar");return i(),l("section",pr,[gr,o("ul",kr,[(i(!0),l(v,null,C(r.members,c=>(i(),l("li",{key:c._id,onClick:e[0]||(e[0]=(...u)=>s.openEditModal&&s.openEditModal(...u))},[m(n,{user:c,diameter:32},null,8,["user"])]))),128)),o("li",null,[o("button",{class:"btn-round",onClick:e[1]||(e[1]=(...c)=>s.openEditModal&&s.openEditModal(...c))})])])])}var br=_(mr,[["render",_r]]);const fr={name:"trello-txt-input",props:{txt:String,placeholder:{type:String,default:""},denyEmptySave:{type:Boolean,default:!1},resetOnSave:{type:Boolean},allowNext:{type:Boolean,default:!1}},data(){return{updatedTxt:this.txt,isInEdit:!1}},methods:{saveTxt(){if(console.log("saving Text!"),!this.updatedTxt)return console.log("this.denyEmptySave",this.denyEmptySave),this.denyEmptySave||(this.isInEdit=!1),this.$emit("txtIsEmpty","");this.$emit("txtSaved",this.updatedTxt),this.resetOnSave&&(this.updatedTxt=""),this.isInEdit=!1},openEdit(t){console.log("event.target.tagName",typeof t.target.tagName),t.target.tagName!=="BUTTON"&&(this.isInEdit=!0)},cancel(){this.updatedTxt=this.txt,this.isInEdit=!1},next(){this.saveTxt(),!this.isInEdit&&this.allowNext&&(this.isInEdit=!0)},handleClickOutside(){!this.isInEdit||(this.updatedTxt?this.saveTxt():this.cancel())}},computed:{txtToShow(){return!this.updatedTxt&&this.placeholder?this.placeholder:this.updatedTxt}}},yr={key:0,class:"flex space-between"},vr={class:"input-title"},Cr={key:1,class:"input-edit"},Tr=["placeholder"],Sr={class:"controlls"};function Er(t,e,r,d,a,s){const n=J("focus"),c=J("clickoutside");return T((i(),l("section",{class:"trello-txt-input",onClick:e[5]||(e[5]=(...u)=>s.openEdit&&s.openEdit(...u))},[a.isInEdit?(i(),l("div",Cr,[T(o("textarea",{cols:"30",rows:"3",onKeydown:[e[0]||(e[0]=R(S((...u)=>s.next&&s.next(...u),["prevent"]),["enter"])),e[1]||(e[1]=R((...u)=>s.cancel&&s.cancel(...u),["esc"]))],"onUpdate:modelValue":e[2]||(e[2]=u=>a.updatedTxt=u),placeholder:r.placeholder},null,40,Tr),[[O,a.updatedTxt],[n]]),o("div",Sr,[o("button",{class:"primary-btn",onClick:e[3]||(e[3]=(...u)=>s.saveTxt&&s.saveTxt(...u))},"Save"),o("button",{class:"cancel-btn",onClick:e[4]||(e[4]=(...u)=>s.cancel&&s.cancel(...u))}),z(t.$slots,"edit-controlls")])])):(i(),l("div",yr,[o("span",vr,k(s.txtToShow),1),z(t.$slots,"default")]))])),[[c,s.handleClickOutside]])}var Y=_(fr,[["render",Er]]);const Mr={name:"activity-log",props:{comments:Array,default:[]},data(){return{updatedComments:this.comments?JSON.parse(JSON.stringify(this.comments)):[],byMember:this.$store.getters.getMyMiniUser}},methods:{formatCreatedAt(t){return N(t,"MMM d")+" at "+N(t,"HH:MM")},addComment(t){const e={id:x.makeId(),txt:t,createdAt:Date.now(),byMember:this.byMember};this.updatedComments.unshift(e),this.$emit("updated",JSON.parse(JSON.stringify(this.updatedComments)))}},computed:{user(){return console.log(this.$store.getters.loggedinUser),this.$store.getters.loggedinUser}},components:{userAvatar:G,trelloTxtInput:Y}},Br={class:"activity-log"},wr=o("span",{class:"section-title text-m icon-activity"},"Activity",-1),$r={class:"clean-list"},Or={class:"user-fullname"},xr={class:"comment-time"};function Dr(t,e,r,d,a,s){const n=p("user-avatar"),c=p("trello-txt-input");return i(),l("section",Br,[wr,o("ul",$r,[o("li",null,[m(n,{user:s.user},null,8,["user"]),m(c,{placeholder:"Write a comment...","deny-empty-save":"","reset-on-save":"",onTxtSaved:s.addComment},null,8,["onTxtSaved"])]),(i(!0),l(v,null,C(a.updatedComments,u=>(i(),l("li",{key:u.id},[m(n,{user:u.byMember},null,8,["user"]),o("span",Or,k(u.byMember.fullname),1),o("span",xr,k(s.formatCreatedAt(u.createdAt)),1),o("p",null,k(u.txt),1)]))),128))])])}var Ir=_(Mr,[["render",Dr]]);const Ar={name:"trello-checklist",props:{checklist:Object,isEditModalMounted:Boolean},data(){return{updatedChecklist:JSON.parse(JSON.stringify(this.checklist)),isDeleteContentTeleported:!1}},methods:{saveChecklist(){const t=JSON.parse(JSON.stringify(this.updatedChecklist));this.$emit("updated",t)},toggleTodoStatus(t){const e=this.updatedChecklist.todos[t];e.isDone=!e.isDone,this.saveChecklist()},updateChecklistTitle(t){this.updatedChecklist.title=t,this.saveChecklist()},updateTodoTitle(t,e){const r=this.updatedChecklist.todos.findIndex(d=>d.id===e);this.updatedChecklist.todos[r].title=t,this.saveChecklist()},removeTodo(t){this.updatedChecklist.todos.splice(t,1),this.saveChecklist()},removeChecklist(){this.$emit("removed"),this.$emit("editModalClosed")},addTodo(t){this.updatedChecklist.todos.push({id:x.makeId(),title:t,isDone:!1}),this.saveChecklist()},next(){this.$refs.input.$el.click()},openDeleteModal(t){this.isDeleteContentTeleported=!0,this.$emit("teleportContainerOpened",t)}},computed:{completePercentage(){const t=this.updatedChecklist.todos,e=t.length;if(e===0)return 0;const r=t.filter(d=>d.isDone).length;return Math.floor(r/e*100)},passSuccess(){return this.completePercentage===100?"success":""}},watch:{isEditModalMounted(t){t||(this.isDeleteContentTeleported=!1)}},components:{trelloTxtInput:Y}},Lr={class:"trello-checklist"},Ur={class:"todos clean-list"},Nr=["checked","onChange"],Gr=["onClick"],Jr=["onClick"],jr=o("p",{class:"msg"},"Deleting a checklist is permanent and there is no way to get it back.",-1);function zr(t,e,r,d,a,s){const n=p("trello-txt-input"),c=p("el-progress");return i(),l("section",Lr,[m(n,{class:"section-title text-m icon-checklist",txt:a.updatedChecklist.title,onTxtSaved:s.updateChecklistTitle,"deny-empty-save":""},{default:y(()=>[o("button",{class:"btn float-right btn-default",onClick:e[0]||(e[0]=(...u)=>s.openDeleteModal&&s.openDeleteModal(...u))},"Delete")]),_:1},8,["txt","onTxtSaved"]),m(c,{percentage:s.completePercentage,status:s.passSuccess},null,8,["percentage","status"]),o("ul",Ur,[(i(!0),l(v,null,C(a.updatedChecklist.todos,(u,b)=>(i(),l("li",{key:u.id},[o("input",{type:"checkbox",checked:u.isDone,onChange:A=>s.toggleTodoStatus(b)},null,40,Nr),m(n,{class:D({done:u.isDone}),txt:u.title,onTxtSaved:A=>s.updateTodoTitle(A,u.id),onTxtIsEmpty:A=>s.removeTodo(b)},{"edit-controlls":y(()=>[o("button",{class:"remove-btn-quite",onClick:A=>s.removeTodo(b)},null,8,Jr)]),default:y(()=>[o("button",{class:"remove-btn-quite",onClick:A=>s.removeTodo(b)},null,8,Gr)]),_:2},1032,["class","txt","onTxtSaved","onTxtIsEmpty"])]))),128))]),m(n,{class:"make-btn",placeholder:"Add an item","deny-empty-save":"","reset-on-save":"",onTxtSaved:s.addTodo,"allow-next":"",ref:"input"},null,8,["onTxtSaved"]),a.isDeleteContentTeleported&&r.isEditModalMounted?(i(),$(Z,{key:0,to:".teleport-container"},[jr,o("button",{onClick:e[1]||(e[1]=(...u)=>s.removeChecklist&&s.removeChecklist(...u)),class:"delete-btn btn"},"Delete checklist")])):h("",!0)])}var Fr=_(Ar,[["render",zr]]);const qr={name:"trello-dates",props:{dueDate:Number,status:String},methods:{openEditModal(t){console.log("event",t),this.$emit("editModalOpened",t,"dateEdit")}},computed:{formatDueDate(){return N(this.dueDate,"MMM d")+" at "+N(this.dueDate,"HH:MM")}}},Pr={class:"trello-dates"},Vr=o("span",{class:"secondary-section-title"},"Due date",-1),Rr={class:"flex-container flex align-center"},Hr=o("input",{type:"checkbox"},null,-1),Wr=o("svg",{width:"24",height:"24",role:"presentation",focusable:"false",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[o("path",{d:"M11.2929 16.7071L4.22185 9.63606C3.83132 9.24554 3.83132 8.61237 4.22185 8.22185C4.61237 7.83133 5.24554 7.83133 5.63606 8.22185L12 14.5858L18.364 8.22185C18.7545 7.83132 19.3877 7.83132 19.7782 8.22185C20.1687 8.61237 20.1687 9.24554 19.7782 9.63606L12.7071 16.7071C12.3166 17.0977 11.6834 17.0977 11.2929 16.7071Z",fill:"currentColor"})],-1);function Zr(t,e,r,d,a,s){return i(),l("section",Pr,[Vr,o("div",Rr,[Hr,o("button",{class:"btn-default flex align-center",onClick:e[0]||(e[0]=(...n)=>s.openEditModal&&s.openEditModal(...n))},[M(k(s.formatDueDate)+" ",1),r.status!=="in-progress"?(i(),l("span",{key:0,class:D(["status-tag",r.status])},k(r.status),3)):h("",!0),Wr])])])}var Yr=_(qr,[["render",Zr]]);const Kr={name:"main-edit-modal",props:{modalTitle:String,pos:Object},mounted(){console.log("Main edit modal is mounted!"),new ResizeObserver(()=>{this.correctPosition()}).observe(this.$refs.elModal),this.$emit("mounted")},data(){return{posCorrected:this.pos?JSON.parse(JSON.stringify(this.pos)):{x:0,y:0},maxHeight:window.innerHeight||document.documentElement.clientHeight}},methods:{closeModal(){this.$emit("editModalClosed")},correctPosition(){if(!this.$refs.elModal||!this.pos)return;const t=JSON.parse(JSON.stringify(this.pos)),e=this.$refs.elModal.getBoundingClientRect(),r={h:window.innerHeight||document.documentElement.clientHeight,w:window.innerWidth||document.documentElement.clientWidth};t.x<0&&(t.x=20),t.x+e.width>r.w&&(t.x=r.w-e.width-20),this.maxHeight=r.h,t.y+e.height>r.h&&(t.y=r.h-e.height-20),t.y<20&&(t.y=20,this.maxHeight=r.h-80),this.posCorrected=t}},computed:{position(){return this.$refs.elModal},elheight(){if(!!this.$refs.elModal)return this.$refs.elModal.getBoundingClientRect().height}},watch:{},unmounted(){console.log("main edit modal is unmounted"),this.$emit("unmounted")}},Xr={class:"edit-modal-header"},Qr={class:"modal-header-title"};function eo(t,e,r,d,a,s){const n=J("clickoutside");return T((i(),l("section",{class:"main-edit-modal",style:f({top:a.posCorrected.y+"px",left:a.posCorrected.x+"px"}),ref:"elModal"},[o("header",Xr,[o("span",Qr,k(r.modalTitle),1),o("button",{class:"exit-btn",onClick:e[0]||(e[0]=(...c)=>s.closeModal&&s.closeModal(...c))})]),o("main",{class:"edit-modal-main",style:f({"max-height":a.maxHeight+"px"})},[z(t.$slots,"default")],4)],4)),[[n,s.closeModal]])}var to=_(Kr,[["render",eo]]);const so={name:"labels-edit",props:{currTask:Object},data(){return{filterBy:"",labelInEdit:null}},methods:{checkIfTaskLabel(t){return this.taskToEdit.labelIds?this.taskToEdit.labelIds.some(e=>e===t.id):!1},toggleLabelFromTask(t){this.taskToEdit.labelIds||(this.taskToEdit.labelIds=[]);var e=this.taskToEdit.labelIds;const r=e.findIndex(d=>d===t.id);r===-1?e.push(t.id):e.splice(r,1),this.$emit("taskUpdated",this.taskToEdit)},saveLabel(){this.$emit("labelUpdated",this.labelInEdit),this.labelInEdit=null}},computed:{labels(){return this.$store.getters.currBoardLabels},taskToEdit(){return JSON.parse(JSON.stringify(this.currTask))},labelsForDisplay(){return this.labels.filter(t=>t.title.toLowerCase().includes(this.filterBy.toLowerCase()))}}},ro={class:"labels-edit"},oo={key:0,class:"all-labels"},ao=o("span",{class:"secondary-section-title"},"Labels",-1),no={class:"clean-list"},io=["onClick"],lo=["onClick"],co={key:1,class:"label-editor"},uo={class:"controlls flex space-between align-center"};function ho(t,e,r,d,a,s){return i(),l("section",ro,[a.labelInEdit?(i(),l("div",co,[o("div",{class:D(["label",[s.checkIfTaskLabel(a.labelInEdit)?"selected":""]]),style:f({"background-color":a.labelInEdit.color})},[T(o("input",{type:"text",placeholder:"Enter label name...","onUpdate:modelValue":e[1]||(e[1]=n=>a.labelInEdit.title=n)},null,512),[[O,a.labelInEdit.title]])],6),o("div",uo,[o("button",{class:"primary-btn",onClick:e[2]||(e[2]=(...n)=>s.saveLabel&&s.saveLabel(...n))},"Save"),o("button",{class:"btn",onClick:e[3]||(e[3]=n=>a.labelInEdit=null)},"Cancel")])])):(i(),l("div",oo,[T(o("input",{class:"search",type:"text",placeholder:"Search labels...","onUpdate:modelValue":e[0]||(e[0]=n=>a.filterBy=n)},null,512),[[O,a.filterBy]]),ao,o("ul",no,[(i(!0),l(v,null,C(s.labelsForDisplay,n=>(i(),l("li",{key:n.id},[o("div",{class:D(["label",[s.checkIfTaskLabel(n)?"selected":"",n.class]]),style:f({"background-color":n.color}),onClick:c=>s.toggleLabelFromTask(n)},[o("span",null,k(n.title),1)],14,io),o("span",{class:"edit-icon",onClick:S(c=>a.labelInEdit=JSON.parse(JSON.stringify(n)),["stop"])},null,8,lo)]))),128))])]))])}var mo=_(so,[["render",ho]]);const po={name:"members-edit",props:{currTask:Object},data(){return{filterBy:""}},methods:{checkIfTaskMember(t){return this.taskToEdit.members?this.taskToEdit.members.some(e=>e._id===t):!1},async toggleMembership(t){this.taskToEdit.members||(this.taskToEdit.members=[]);var e=this.taskToEdit.members;const r=e.findIndex(d=>d._id===t._id);r===-1?e.push(t):e.splice(r,1),this.$emit("taskUpdated",this.taskToEdit)}},computed:{currBoardMembers(){return this.$store.getters.currBoardMembers},membersForDisplay(){return this.currBoardMembers.filter(t=>t.username.toLowerCase().includes(this.filterBy.toLowerCase())||t.fullname.toLowerCase().includes(this.filterBy.toLowerCase()))},taskToEdit(){return JSON.parse(JSON.stringify(this.currTask))}},components:{userAvatar:G}},go={class:"members-edit"},ko=o("span",{class:"secondary-section-title"},"Board members",-1),_o=["onClick"],bo={class:"member"};function fo(t,e,r,d,a,s){const n=p("user-avatar");return i(),l("section",go,[T(o("input",{class:"search",type:"text",placeholder:"Search members","onUpdate:modelValue":e[0]||(e[0]=c=>a.filterBy=c)},null,512),[[O,a.filterBy]]),ko,o("ul",null,[(i(!0),l(v,null,C(s.membersForDisplay,c=>(i(),l("li",{key:c._id,class:D(["flex align-center",{selected:s.checkIfTaskMember(c._id)}]),onClick:u=>s.toggleMembership(c)},[m(n,{user:c,diameter:32},null,8,["user"]),o("div",bo,[o("span",null,k(c.fullname+" ("+c.username+")"),1)])],10,_o))),128))])])}var yo=_(po,[["render",fo]]);const vo={name:"checklists-edit",props:{currTask:Object},data(){return{newChecklist:{id:"",title:"Checklist",todos:[]},todosToCopy:[]}},methods:{createChecklist(){this.newChecklist.id=x.makeId(),this.newChecklist.todos=JSON.parse(JSON.stringify(this.todosToCopy.flat())).map(t=>(console.log("todo",t),t.id=x.makeId(),t)),this.taskToEdit.checklists||(this.taskToEdit.checklists=[]),this.taskToEdit.checklists.push(JSON.parse(JSON.stringify(this.newChecklist))),this.$emit("taskUpdated",this.taskToEdit),this.newChecklist={id:null,title:"Checklist",todos:[]},this.$emit("modalClosed")}},computed:{checklists(){return this.$store.getters.currBoardChecklists},taskToEdit(){return JSON.parse(JSON.stringify(this.currTask))}}},Co={class:"checklists-edit"},To=o("span",{class:"secondary-section-title"},"Title",-1),So=o("span",{class:"secondary-section-title"},"Copy items from...",-1),Eo=o("option",{value:[]},"(none)",-1),Mo=["label"],Bo=["value"];function wo(t,e,r,d,a,s){const n=J("focus");return i(),l("section",Co,[To,T(o("input",{class:"search",type:"text","onUpdate:modelValue":e[0]||(e[0]=c=>a.newChecklist.title=c)},null,512),[[n],[O,a.newChecklist.title]]),So,T(o("select",{"onUpdate:modelValue":e[1]||(e[1]=c=>a.todosToCopy=c),multiple:""},[Eo,(i(!0),l(v,null,C(s.checklists,c=>(i(),l("optgroup",{key:c.taskId,label:c.taskTitle},[(i(!0),l(v,null,C(c.checklists,u=>(i(),l("option",{key:u.id,value:u.todos},k(u.title),9,Bo))),128))],8,Mo))),128))],512),[[ye,a.todosToCopy]]),o("button",{class:"primary-btn",onClick:e[2]||(e[2]=(...c)=>s.createChecklist&&s.createChecklist(...c))},"Add")])}var $o=_(vo,[["render",wo]]);const Oo={name:"date-edit",props:{currTask:Object},components:{Datepicker:ve},data(){return{startDate:null,dueDate:null,taskDate:null,currTaskDates:{startDate:null,endDate:null,endTime:null,date:null}}},computed:{taskToEdit(){return JSON.parse(JSON.stringify(this.currTask))}},mounted(){this.currTask.dueDate?this.dueDate=new Date(this.currTask.dueDate):this.dueDate=null},methods:{selectDate(){var t=document.querySelector(".dp__selection_preview"),e=Date.parse(t.innerText);this.taskToEdit.dueDate=e,console.log(this.taskToEdit),this.dueDate-Date.now()<0&&(this.taskToEdit.status="over-due"),this.dueDate-Date.now()<86400*1e3&&(this.taskToEdit.status="due-soon"),this.dueDate-Date.now()>86400*1e3&&(this.taskToEdit.status="in-progress"),this.$emit("taskUpdated",this.taskToEdit)},test(){console.log(modelValue)}}},xo={class:"date-edit"},Do={key:0,class:"date-title"};function Io(t,e,r,d,a,s){const n=p("Datepicker");return i(),l("section",xo,[m(n,{AutoApply:"",modelValue:a.dueDate,"onUpdate:modelValue":[e[1]||(e[1]=c=>a.dueDate=c),s.test],utc:"",inline:"",startTime:{},monthChangeOnScroll:!1,weekStart:"0",monthNameFormat:"long"},{"action-select":y(()=>[o("button",{class:"btn-save-date",onClick:e[0]||(e[0]=(...c)=>s.selectDate&&s.selectDate(...c))},"Save")]),_:1},8,["modelValue","onUpdate:modelValue"]),r.currTask.dueDate?(i(),l("p",Do,"Due date")):h("",!0),o("pre",null,k(a.taskDate),1)])}var Ao=_(Oo,[["render",Io]]);const ue=t=>{const e="dxj8szufc",d="https://api.cloudinary.com/v1_1/dxj8szufc/image/upload",a=new FormData;return a.append("file",t.target.files[0]),a.append("upload_preset",e),fetch(d,{method:"POST",body:a}).then(s=>s.json()).then(s=>s).catch(s=>{throw console.error(s),s})};var Lo="/assets/Upload-PNG-Image-File.0ddaa69b.png",Uo="/assets/loader.fd6c922f.gif",No="/assets/checkmark-cut.81d2fd44.gif",Go="/assets/ezgif.com-gif-maker.29a621cd.gif";const Jo={name:"attachment-edit",props:{currTask:Object},created(){this.currStatus=this.statusOptions.waiting},data(){return{currStatus:null,statusOptions:{waiting:{txt:"Upload file",isWaiting:!0},loading:{txt:"Loading...",isLoading:!0,txtColor:"#00c2e0"},complete:{txt:"Attachment added successfuly!",isComplete:!0,txtColor:"#61bd4f"},failed:{txt:"OOPS! File upload failed!",isFailed:!0,txtColor:"#eb5a46"}}}},methods:{async onUpload(t){console.log("ev.target.files[0]",t.target.files[0]),this.currStatus=this.statusOptions.loading;try{const e=await ue(t);this.taskToEdit.attachments||(this.taskToEdit.attachments=[]),this.taskToEdit.attachments.push(e),console.log("this.taskToEdit",this.taskToEdit),this.$emit("taskUpdated",this.taskToEdit),this.currStatus=this.statusOptions.complete}catch{this.currStatus=this.statusOptions.failed}setTimeout(()=>{this.closeModal(),this.$refs.checkmarkImg.src+=`?v=${Date.now()}`},2e3)},closeModal(){this.$emit("editModalClosed")}},computed:{taskToEdit(){return JSON.parse(JSON.stringify(this.currTask))}}},jo={class:"attachment-edit flex column"},zo=o("span",{class:"secondary-section-title"},"Upload file",-1),Fo={key:0},qo=["alt"],Po={key:1,class:"status-msg flex align-center"},Vo=o("img",{class:"status-icon",src:Uo},null,-1),Ro={key:2,class:"status-msg flex align-center"},Ho={class:"status-icon",src:No,ref:"checkmarkImg"},Wo={key:3,class:"status-msg flex align-center"},Zo=o("img",{class:"status-icon",src:Go},null,-1);function Yo(t,e,r,d,a,s){const n=J("focus");return i(),l("section",jo,[zo,a.currStatus.isWaiting?(i(),l("label",Fo,[o("img",{class:"upload-icon",src:Lo,alt:a.currStatus.txt},null,8,qo),T(o("input",{class:"search",type:"file",onChange:e[0]||(e[0]=(...c)=>s.onUpload&&s.onUpload(...c))},null,544),[[n]])])):a.currStatus.isLoading?(i(),l("div",Po,[o("span",{class:"secondary-section-title",style:f({color:a.currStatus.txtColor})},k(a.currStatus.txt),5),Vo])):a.currStatus.isComplete?(i(),l("div",Ro,[o("span",{class:"secondary-section-title",style:f({color:a.currStatus.txtColor})},k(a.currStatus.txt),5),o("img",Ho,null,512)])):a.currStatus.isFailed?(i(),l("div",Wo,[o("span",{class:"secondary-section-title",style:f({color:a.currStatus.txtColor})},k(a.currStatus.txt),5),Zo])):h("",!0)])}var Ko=_(Jo,[["render",Yo]]);const Xo={name:"trello-attachments",props:{attachments:Array,isEditModalMounted:Boolean},data(){return{attachmentToEditIdx:NaN,isDeleteContentTeleported:!1,isNameContentTeleported:!1}},methods:{removeAttachment(){this.updatedAttachments.splice(this.attachmentToEditIdx,1),this.$emit("updated",this.updatedAttachments),this.$emit("editModalClosed")},openEditModal(t){this.$emit("editModalOpened",t)},openDeleteModal(t,e){console.log("event",t),this.attachmentToEditIdx=e,this.isDeleteContentTeleported=!0,this.$emit("teleportContainerOpened",t)},openNameModal(t,e){this.attachmentToEditIdx=e,this.isNameContentTeleported=!0,this.$emit("teleportContainerOpened",t)},formatCreatedAt(t){const e=new Date(t.created_at).getTime();return console.log("createdAt",e),N(e,"MMM d")+" at "+N(e,"HH:MM")}},computed:{updatedAttachments(){return JSON.parse(JSON.stringify(this.attachments))}},watch:{isEditModalMounted(t){t||(this.isDeleteContentTeleported=!1,this.isNameContentTeleported=!1)}}},Qo={class:"trello-attachments"},ea=o("div",{class:"section-title text-m icon-attachment"},"Attachments",-1),ta={class:"attachments clean-list"},sa=["src","alt"],ra={class:"file-details"},oa={class:"attachment-name"},aa={class:"attachment-addedAt"},na={class:"attachment-delete"},ia=["onClick"],la={class:"attachment-edit-name"},da=["onClick"],ca={class:"attachment-make-cover"},ua=["onClick"],ha=o("p",{class:"msg"},"Deleting an attachment is permanent. There is no undo.",-1);function ma(t,e,r,d,a,s){return i(),l("section",Qo,[ea,o("ul",ta,[(i(!0),l(v,null,C(r.attachments,(n,c)=>(i(),l("li",{class:"flex align-center",key:n.asset_id},[o("img",{class:"img-preview",src:n.secure_url,alt:n.original_filename},null,8,sa),o("p",ra,[o("span",oa,k(n.original_filename+"."+n.format),1),o("span",aa,"Added at "+k(s.formatCreatedAt(n)),1),o("span",na,[o("a",{href:"#",onClick:S(u=>s.openDeleteModal(u,c),["prevent"])},"Delete",8,ia)]),o("span",la,[o("a",{href:"#",onClick:S(u=>s.openNameModal(u,c),["prevent"])},"Edit",8,da)]),o("span",ca,[o("a",{href:"#",onClick:S(u=>t.makeCover(c),["prevent"])},"Make-cover",8,ua)])])]))),128))]),o("button",{class:"btn",onClick:e[0]||(e[0]=(...n)=>s.openEditModal&&s.openEditModal(...n))},"Add an attachment"),a.isDeleteContentTeleported&&r.isEditModalMounted?(i(),$(Z,{key:0,to:".teleport-container"},[ha,o("button",{onClick:e[1]||(e[1]=(...n)=>s.removeAttachment&&s.removeAttachment(...n)),class:"delete-btn btn"},"Delete")])):h("",!0)])}var pa=_(Xo,[["render",ma]]);const ga={name:"cover-edit",props:{currTask:Object},data(){return{currStatus:null,statusOptions:{waiting:{imgName:"Upload-PNG-Image-File.png",txt:"Upload file",isWaiting:!0},loading:{imgName:"loader.gif",txt:"Loading...",isLoading:!0},complete:{imgName:"checkmark-cut.gif",txt:"Attachment added successfuly!"},failed:{imgName:"ezgif.com-gif-maker.gif",txt:"OOPS! File upload failed!"}}}},created(){this.currStatus=this.statusOptions.waiting},methods:{openSearch(){this.$emit("openSearch")},async onUpload(t){console.log("ev.target.files[0]",t.target.files[0]),this.currStatus=this.statusOptions.loading;try{const e=await ue(t);console.log(e),this.taskToEdit.attachments||(this.taskToEdit.attachments=[]),this.taskToEdit.attachments.push(e),console.log("this.taskToEdit",this.taskToEdit),this.$emit("taskUpdated",this.taskToEdit),this.currStatus=this.statusOptions.complete}catch{this.currStatus=this.statusOptions.failed}},setCoverClr(t){console.log(this.taskToEdit),this.taskToEdit.style||(this.taskToEdit.style={}),this.taskToEdit.style.bg=t,this.taskToEdit.style.size||(this.taskToEdit.style.size="small"),this.$emit("taskUpdated",this.taskToEdit)},setCoverImg(t){this.taskToEdit.style||(this.taskToEdit.style={}),this.taskToEdit.style.bg=t,this.taskToEdit.style.size||(this.taskToEdit.style.size="big"),this.$emit("taskUpdated",this.taskToEdit),console.log(this.currTask)},setCoverSize(t){console.log(this.taskToEdit),this.taskToEdit.style||(this.taskToEdit.style={}),this.taskToEdit.style.size=t,this.taskToEdit.style.bg||(this.taskToEdit.style.bg="#7BC86C"),this.$emit("taskUpdated",this.taskToEdit)},removeCover(){delete this.taskToEdit.style,console.log(this.taskToEdit),this.$emit("taskUpdated",this.taskToEdit)}},computed:{getBg(){var t=JSON.parse(JSON.stringify(this.currTask));if(t.style||(t.style={},t.style.bg=""),t.style.bg)return console.log(t.style),t.style.bg.split("")[0]==="#"?`background-color: ${t.style.bg}; opacity:1`:`background-image: url('${t.style.bg}'); opacity:1; background-color:transparent;`},getLine(){if(this.currTask.style)return"colorized"},taskToEdit(){return JSON.parse(JSON.stringify(this.currTask))}},components:{}},ka={class:"cover-edit"},_a=o("h4",null,"Size",-1),ba={class:"flex center align-center"},fa=["checked"],ya={class:"cover-opt small"},va=Ce('<div class="line"></div><div class="line"></div><div class="cube"></div><div class="cube"></div><div class="circle"></div>',5),Ca=[va],Ta=["checked"],Sa={class:"cover-opt big"},Ea=o("div",{class:"line"},null,-1),Ma=o("div",{class:"line"},null,-1),Ba=[Ea,Ma],wa=o("h4",null,"Colors",-1),$a={class:"btn-cover-container flex center wrap"},Oa=["checked"],xa=o("div",{class:"btn-clr green"},null,-1),Da=["checked"],Ia=o("div",{class:"btn-clr yellow"},null,-1),Aa=["checked"],La=o("div",{class:"btn-clr orange"},null,-1),Ua=["checked"],Na=o("div",{class:"btn-clr red"},null,-1),Ga=["checked"],Ja=o("div",{class:"btn-clr purple"},null,-1),ja=["checked"],za=o("div",{class:"btn-clr blue"},null,-1),Fa=["checked"],qa=o("div",{class:"btn-clr lightblue"},null,-1),Pa=["checked"],Va=o("div",{class:"btn-clr turquoise"},null,-1),Ra=["checked"],Ha=o("div",{class:"btn-clr pink"},null,-1),Wa=["checked"],Za=o("div",{class:"btn-clr navy"},null,-1),Ya=o("h4",null,"Attachments",-1),Ka={key:1,class:"btn-cover-container img-container flex wrap"},Xa=["onClick"],Qa=["checked"],en={class:"btn-clr cover-opt-img"},tn=["src"],sn={key:2,class:"btn-upload-cover"},rn=M(" Upload a cover image "),on={key:3},an=["src"];function nn(t,e,r,d,a,s){return i(),l("section",ka,[_a,o("div",ba,[o("label",null,[o("input",{onClick:e[0]||(e[0]=n=>s.setCoverSize("small")),checked:r.currTask.style&&r.currTask.style.size=="small",type:"radio",name:"cover-opt"},null,8,fa),o("div",ya,[o("div",{class:"cover-opt-header",style:f(s.getBg)},null,4),o("div",{class:D(["cover-opt-lines",s.getLine])},Ca,2)])]),o("label",null,[o("input",{onClick:e[1]||(e[1]=n=>s.setCoverSize("big")),checked:r.currTask.style&&r.currTask.style.size=="big",type:"radio",name:"cover-opt",value:"true"},null,8,Ta),o("div",Sa,[o("div",{style:f(s.getBg),class:"big-container"},[o("div",{class:D(["cover-opt-lines",s.getLine])},Ba,2)],4)])])]),r.currTask.style?(i(),l("button",{key:0,onClick:e[2]||(e[2]=(...n)=>s.removeCover&&s.removeCover(...n)),class:"btn-remove-cover"},"Remove cover")):h("",!0),wa,o("div",$a,[o("label",{onClick:e[3]||(e[3]=n=>s.setCoverClr("#7BC86C"))},[o("input",{checked:r.currTask.style&&r.currTask.style.bg=="#7BC86C",type:"radio",name:"btn-clr"},null,8,Oa),xa]),o("label",{onClick:e[4]||(e[4]=n=>s.setCoverClr("#f5dd29"))},[o("input",{checked:r.currTask.style&&r.currTask.style.bg=="#f5dd29",type:"radio",name:"btn-clr"},null,8,Da),Ia]),o("label",{onClick:e[5]||(e[5]=n=>s.setCoverClr("#FFAF3F"))},[o("input",{checked:r.currTask.style&&r.currTask.style.bg=="#FFAF3F",type:"radio",name:"btn-clr"},null,8,Aa),La]),o("label",{onClick:e[6]||(e[6]=n=>s.setCoverClr("#EF7564"))},[o("input",{checked:r.currTask.style&&r.currTask.style.bg=="#EF7564",type:"radio",name:"btn-clr"},null,8,Ua),Na]),o("label",{onClick:e[7]||(e[7]=n=>s.setCoverClr("#CD8DE5"))},[o("input",{checked:r.currTask.style&&r.currTask.style.bg=="#CD8DE5",type:"radio",name:"btn-clr"},null,8,Ga),Ja]),o("label",{onClick:e[8]||(e[8]=n=>s.setCoverClr("#5BA4CF"))},[o("input",{checked:r.currTask.style&&r.currTask.style.bg=="#5BA4CF",type:"radio",name:"btn-clr"},null,8,ja),za]),o("label",{onClick:e[9]||(e[9]=n=>s.setCoverClr("#29CCE5"))},[o("input",{checked:r.currTask.style&&r.currTask.style.bg=="#29CCE5",type:"radio",name:"btn-clr"},null,8,Fa),qa]),o("label",{onClick:e[10]||(e[10]=n=>s.setCoverClr("#6DECA9"))},[o("input",{checked:r.currTask.style&&r.currTask.style.bg=="#6DECA9",type:"radio",name:"btn-clr"},null,8,Pa),Va]),o("label",{onClick:e[11]||(e[11]=n=>s.setCoverClr("#FF8ED4"))},[o("input",{checked:r.currTask.style&&r.currTask.style.bg=="#FF8ED4",type:"radio",name:"btn-clr"},null,8,Ra),Ha]),o("label",{onClick:e[12]||(e[12]=n=>s.setCoverClr("#172B4D"))},[o("input",{checked:r.currTask.style&&r.currTask.style.bg=="#172B4D",type:"radio",name:"btn-clr"},null,8,Wa),Za])]),Ya,r.currTask.attachments?(i(),l("div",Ka,[(i(!0),l(v,null,C(r.currTask.attachments,n=>(i(),l("label",{key:n.asset_id,onClick:c=>s.setCoverImg(n.secure_url)},[o("input",{checked:r.currTask.style&&r.currTask.style.bg==n.secure_url,type:"radio",name:"btn-clr"},null,8,Qa),o("div",en,[o("img",{class:"cover-opt-img",src:n.secure_url,alt:""},null,8,tn)])],8,Xa))),128))])):h("",!0),a.currStatus.isWaiting||!a.currStatus.isLoading?(i(),l("label",sn,[rn,o("input",{type:"file",class:"attach",onChange:e[13]||(e[13]=(...n)=>s.onUpload&&s.onUpload(...n))},null,32)])):h("",!0),a.currStatus.isLoading?(i(),l("div",on,[o("img",{src:"../../../../src/assets/"+a.currStatus.imgName},null,8,an),o("span",null,k(a.currStatus.txt),1)])):h("",!0),o("button",{onClick:e[14]||(e[14]=S((...n)=>s.openSearch&&s.openSearch(...n),["stop"])),class:"btn-search-photo"},"Search for photos")])}var ln=_(ga,[["render",nn]]);const dn={name:"teleport-container"},cn={class:"teleport-container"};function un(t,e,r,d,a,s){return i(),l("section",cn)}var hn=_(dn,[["render",un]]);const mn={query:pn};async function pn(t){return(await de({method:"get",url:"https://api.unsplash.com/search/photos",params:{client_id:"wfRMyNNl6BtufTtEgOm1agD3oTHPI-ymhw9iJXaCr98",query:t,page:1,per_page:20,orientation:"landscape",w:"2560",h:"1560"}})).data}const gn={name:"search-photo",props:{currTask:Object},data(){return{isSearching:!1,res:null}},created(){this.searchImg=x.debounce(this.searchImg,1e3)},methods:{async searchImg(){const t=this.$refs.filterBy.value;if(!t){this.isSearching=!1,this.res=null;return}this.res=await mn.query(t),this.isSearching=!0,console.log(this.res),this.res=this.res.results.map(e=>({small:e.urls.thumb,regular:e.urls.regular,big:e.urls.full,asset_id:e.id,format:"png",original_filename:e.alt_description,secure_url:e.urls.regular,created_at:e.created_at}))},setImg(t){this.taskToEdit.style||(this.taskToEdit.style={}),this.taskToEdit.style.bg=t.regular,this.taskToEdit.style.size||(this.taskToEdit.style.size="big"),this.taskToEdit.attachments||(this.taskToEdit.attachments=[]),this.taskToEdit.attachments.push(t),this.$emit("taskUpdated",this.taskToEdit),this.$emit("closeSearch")},setSuggestSearch(t){this.$refs.filterBy.value=t,this.searchImg()}},computed:{taskToEdit(){return JSON.parse(JSON.stringify(this.currTask))}}},kn={class:"search-photo"},_n={key:0},bn=o("h4",null,"Suggested searches",-1),fn={class:"suggested-container flex wrap"},yn={key:1},vn=o("h4",null,"Results",-1),Cn={class:"search-results flex wrap"},Tn=["onClick"],Sn=["src"];function En(t,e,r,d,a,s){return i(),l("section",kn,[o("input",{ref:"filterBy",onInput:e[0]||(e[0]=(...n)=>s.searchImg&&s.searchImg(...n)),class:"img-search-input",type:"text",placeholder:"Search for photos"},null,544),a.isSearching?h("",!0):(i(),l("section",_n,[bn,o("div",fn,[o("button",{onClick:e[1]||(e[1]=n=>s.setSuggestSearch("Perspective")),class:"btn-search-opt"},"Perspective"),o("button",{onClick:e[2]||(e[2]=n=>s.setSuggestSearch("Productivity")),class:"btn-search-opt"},"Productivity"),o("button",{onClick:e[3]||(e[3]=n=>s.setSuggestSearch("Oraganization")),class:"btn-search-opt"},"Oraganization"),o("button",{onClick:e[4]||(e[4]=n=>s.setSuggestSearch("Colorful")),class:"btn-search-opt"},"Colorful"),o("button",{onClick:e[5]||(e[5]=n=>s.setSuggestSearch("Nature")),class:"btn-search-opt"},"Nature"),o("button",{onClick:e[6]||(e[6]=n=>s.setSuggestSearch("Business")),class:"btn-search-opt"},"Business"),o("button",{onClick:e[7]||(e[7]=n=>s.setSuggestSearch("Minimal")),class:"btn-search-opt"},"Minimal"),o("button",{onClick:e[8]||(e[8]=n=>s.setSuggestSearch("Space")),class:"btn-search-opt"},"Space"),o("button",{onClick:e[9]||(e[9]=n=>s.setSuggestSearch("Animals")),class:"btn-search-opt"},"Animals")])])),a.res?(i(),l("section",yn,[vn,o("section",Cn,[(i(!0),l(v,null,C(a.res,n=>(i(),l("div",{onClick:S(c=>s.setImg(n),["stop"]),class:"res-container",key:n},[o("img",{src:n.small,alt:""},null,8,Sn)],8,Tn))),128))])])):h("",!0)])}var Mn=_(gn,[["render",En]]);const Bn={name:"task-details",async created(){this.currTaskId=this.$route.params.taskId,this.parentGroupId=this.$route.params.groupId,this.parentGroupName=this.$store.getters.currBoard.groups.find(r=>r.id===this.parentGroupId).title;const{groupId:t,taskId:e}=this.$route.params;await this.$store.dispatch({type:"loadCurrTask",groupId:t,taskId:e})},data(){return{editModalStatus:{isOpen:!1,editType:"",pos:null,title:""},isDeleteContentTeleported:!1,isEditModalMounted:!1,currTaskId:"",parentGroupId:"",parentGroupName:""}},mounted(){},methods:{checkImg(){return this.currTask.style.bg.split("")[0]!=="#"},openSearch(){this.editModalStatus.editType="search-photo"},async saveCurrTask(t=null){const e=t||this.currTask;await this.$store.dispatch({type:"saveTask",groupId:this.parentGroupId,taskToSave:JSON.parse(JSON.stringify(e))}),console.log("Current task saved!")},async removeTask(){const t=this.$route.params.groupId,e=await this.$store.dispatch({type:"removeTask",groupId:t,taskId:this.currTask.id});this.$router.push(`/board/${e._id}`)},updateDesc(t){console.log("updatedDesc",t),this.currTask.description=t,this.saveCurrTask()},updateChecklist(t){const e=this.currTask.checklists.findIndex(r=>r.id===t.id);this.currTask.checklists[e]=t,this.saveCurrTask()},updateLabel(t){t=JSON.parse(JSON.stringify(t)),this.$store.dispatch({type:"updateLabel",label:t})},removeChecklist(t){this.currTask.checklists.splice(t,1),this.saveCurrTask()},updateComments(t){this.currTask.comments=t,this.saveCurrTask()},updateAttachments(t){this.currTask.attachments=t,this.saveCurrTask()},closeModal(){this.saveCurrTask();const t=this.$route.params.boardId;this.$router.push({name:"board",params:{boardId:t}})},openDeleteModal(t){this.isDeleteContentTeleported=!0,this.openEditModal(t,"teleportContainer","Delete card?")},openEditModal(t,e,r=""){console.log("event",t);var d;if(!t)d=this.pos;else{const s=t.target.getBoundingClientRect();d={x:s.x,y:s.y-s.height-10}}if(!r)switch(e){case"labels-edit":case"labelsEdit":r="Labels";break;case"members-edit":case"membersEdit":r="Members";break;case"checklists-edit":case"checklistsEdit":r="Add checklist";break;case"date-edit":case"dateEdit":r="Dates";break;case"attachment-edit":case"attachmentEdit":r="Attach from computer";break;case"cover-edit":case"coverEdit":r="Cover";break;case"search-photo":case"searchPhoto":r="Photo search"}console.log("title",r);const a={isOpen:!0,editType:e,pos:d,title:r};this.editModalStatus=a},closeEditModal(){this.editModalStatus={isOpen:!1,editType:"",pos:null,title:""}}},computed:{getCoverClr(){return`background-color: ${this.currTask.style.bg} !important`},boardLabels(){return this.$store.getters.currBoardLabels},hasLabels(){return this.currTaskLabels&&this.currTaskLabels.length>0},hasMembers(){if(!!this.currTask)return this.currTask.members&&this.currTask.members.length>0},hasAttachments(){return this.currTask.attachments&&this.currTask.attachments.length},currTask(){return this.$store.getters.getCurrTask},currTaskLabels(){return!this.currTask.labelIds||!this.currTask.labelIds.length?[]:this.boardLabels.filter(t=>this.currTask.labelIds.includes(t.id))}},watch:{isEditModalMounted(t){t||(this.isDeleteContentTeleported=!1)}},components:{mainEditModal:to,trelloLabels:hr,trelloMembers:br,activityLog:Ir,trelloChecklist:Fr,trelloTxtInput:Y,trelloDates:Yr,labelsEdit:mo,membersEdit:yo,checklistsEdit:$o,dateEdit:Ao,attachmentEdit:Ko,trelloAttachments:pa,coverEdit:ln,teleportContainer:hn,searchPhoto:Mn}},wn={key:0,class:"task-details"},$n={class:"modal-screen flex center"},On={class:"modal-container flex column center"},xn={key:1,class:"cover"},Dn=["src"],In={class:"modal-header section-title text-l icon-task-title"},An={class:"group-data"},Ln=M(" in list "),Un={class:"flex-container flex space-between"},Nn={class:"modal-main"},Gn={key:0,class:"notations flex wrap"},Jn={key:1,class:"gutter"},jn={class:"description"},zn=o("span",{class:"section-title text-m icon-description"},"Description",-1),Fn={key:2,class:"attachments"},qn={key:3,class:"checklists"},Pn={class:"activity-log"},Vn={class:"modal-sidebar flex column"},Rn=o("span",{class:"secondary-section-title"},"Add to card",-1),Hn=o("span",{class:"secondary-section-title"},"Actions",-1),Wn=o("p",{class:"msg"},"All actions will be removed from the activity feed and you won\u2019t be able to re-open the card. There is no undo.",-1);function Zn(t,e,r,d,a,s){const n=p("trello-members"),c=p("trello-labels"),u=p("trello-dates"),b=p("trello-txt-input"),A=p("trello-attachments"),P=p("trello-checklist"),V=p("activity-log"),B=p("main-edit-modal"),w=J("clickoutside");return s.currTask?(i(),l("section",wn,[o("div",$n,[T((i(),l("div",On,[h("",!0),s.currTask.style?(i(),l("div",xn,[s.currTask.style&&s.currTask.style.bg.split("")[0]!=="#"?(i(),l("img",{key:0,src:s.currTask.style.bg,alt:""},null,8,Dn)):(i(),l("div",{key:1,style:f(s.getCoverClr),class:"cover-clr"},null,4))])):h("",!0),o("button",{class:"exit-btn",onClick:e[0]||(e[0]=(...g)=>s.closeModal&&s.closeModal(...g))}),o("div",In,[T(o("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=g=>s.currTask.title=g),class:"group-title task-details-title",onBlur:e[2]||(e[2]=g=>s.saveCurrTask(s.currTask))},null,544),[[O,s.currTask.title]]),o("div",An,[Ln,o("a",{onClick:e[3]||(e[3]=S(()=>{},["prevent"])),href:"#"},k(a.parentGroupName),1)])]),o("div",Un,[o("div",Nn,[s.hasMembers||s.hasLabels||s.currTask.dueDate?(i(),l("div",Gn,[s.hasMembers?(i(),$(n,{key:0,members:s.currTask.members,onEditModalOpened:s.openEditModal},null,8,["members","onEditModalOpened"])):h("",!0),s.hasLabels?(i(),$(c,{key:1,labels:s.currTaskLabels,onEditModalOpened:s.openEditModal},null,8,["labels","onEditModalOpened"])):h("",!0),s.currTask.dueDate?(i(),$(u,{key:2,dueDate:s.currTask.dueDate,status:s.currTask.status,onEditModalOpened:s.openEditModal},null,8,["dueDate","status","onEditModalOpened"])):h("",!0)])):(i(),l("div",Jn)),o("div",jn,[zn,m(b,{class:"make-btn",txt:s.currTask.description,placeholder:"Add a more detailed description\u2026",onTxtSaved:s.updateDesc,onTxtIsEmpty:s.updateDesc},null,8,["txt","onTxtSaved","onTxtIsEmpty"])]),s.hasAttachments?(i(),l("div",Fn,[m(A,{attachments:s.currTask.attachments,isEditModalMounted:a.isEditModalMounted,onEditModalOpened:e[4]||(e[4]=g=>s.openEditModal(g,"attachmentEdit")),onTeleportContainerOpened:e[5]||(e[5]=g=>s.openEditModal(g,"teleportContainer","Delete attachment?")),onUpdated:s.updateAttachments},null,8,["attachments","isEditModalMounted","onUpdated"])])):h("",!0),(i(),l("div",qn,[(i(!0),l(v,null,C(s.currTask.checklists,(g,ke)=>(i(),$(P,{key:g.id,checklist:g,isEditModalMounted:a.isEditModalMounted,onUpdated:s.updateChecklist,onRemoved:ee=>s.removeChecklist(ke),onEditModalClosed:s.closeEditModal,onTeleportContainerOpened:e[6]||(e[6]=ee=>s.openEditModal(ee,"teleportContainer","Delete Checklist?"))},null,8,["checklist","isEditModalMounted","onUpdated","onRemoved","onEditModalClosed"]))),128))])),o("div",Pn,[m(V,{comments:s.currTask.comments,onUpdated:s.updateComments},null,8,["comments","onUpdated"])])]),o("div",Vn,[Rn,o("button",{class:"btn side-bar icon-members",onClick:e[7]||(e[7]=g=>s.openEditModal(g,"members-edit"))},"Members"),o("button",{class:"btn side-bar icon-labels",onClick:e[8]||(e[8]=g=>s.openEditModal(g,"labels-edit"))},"Labels"),o("button",{class:"btn side-bar icon-checklist",onClick:e[9]||(e[9]=g=>s.openEditModal(g,"checklists-edit"))},"Checklist"),o("button",{class:"btn side-bar icon-dates",onClick:e[10]||(e[10]=g=>s.openEditModal(g,"date-edit"))},"Dates"),o("button",{class:"btn side-bar icon-attachment",onClick:e[11]||(e[11]=g=>s.openEditModal(g,"attachment-edit"))},"Attachment"),o("button",{class:"btn side-bar icon-cover",onClick:e[12]||(e[12]=g=>s.openEditModal(g,"cover-edit"))},"Cover"),Hn,o("button",{class:"btn side-bar icon-copy",onClick:e[13]||(e[13]=g=>s.openEditModal(g,"copy-edit"))},"Copy"),o("button",{class:"btn delete-btn side-bar icon-delete",onClick:e[14]||(e[14]=(...g)=>s.openDeleteModal&&s.openDeleteModal(...g))},"Delete")])]),m(le,{"enter-active-class":"animate__animated animate__fadeIn animate__faster","leave-active-class":"animate__animated animate__fadeOut animate__faster"},{default:y(()=>[a.editModalStatus.isOpen?(i(),$(B,{key:0,"modal-title":a.editModalStatus.title,onEditModalClosed:s.closeEditModal,pos:a.editModalStatus.pos,onMounted:e[17]||(e[17]=g=>this.isEditModalMounted=!0),onUnmounted:e[18]||(e[18]=g=>this.isEditModalMounted=!1)},{default:y(()=>[(i(),$(Te(a.editModalStatus.editType),{currTask:s.currTask,onTaskUpdated:s.saveCurrTask,onEditModalClosed:s.closeEditModal,onLabelUpdated:s.updateLabel,onOpenSearch:e[15]||(e[15]=g=>s.openEditModal(void 0,"search-photo")),onCloseSearch:e[16]||(e[16]=g=>s.openEditModal(void 0,"cover-edit"))},null,8,["currTask","onTaskUpdated","onEditModalClosed","onLabelUpdated"]))]),_:1},8,["modal-title","onEditModalClosed","pos"])):h("",!0)]),_:1}),a.isDeleteContentTeleported&&a.isEditModalMounted?(i(),$(Z,{key:2,to:".teleport-container"},[Wn,o("button",{onClick:e[19]||(e[19]=(...g)=>s.removeTask&&s.removeTask(...g)),class:"delete-btn btn"},"Delete")])):h("",!0)])),[[w,s.closeModal]])])])):h("",!0)}var Yn=_(Bn,[["render",Zn]]);const Kn={data(){return{user:{username:null,password:null}}},methods:{async login(){try{await this.$store.dispatch({type:"login",userCred:this.user})&&this.$router.push("/board")}catch(t){console.log("ERROR: cannot login. User and/or password are incorrect",t);const e={txt:"Invalid username or password",type:"error"};await this.$store.dispatch({type:"showMsg",msg:e})}}}},Xn={class:"login-signup"},Qn={class:"header-home"},ei=o("div",{class:"logo"},[o("span",{class:"material-icons-outlined logo-icon"}),M("Mello ")],-1),ti={class:"homepage-nav"},si=M("Home"),ri=o("span",null," | ",-1),oi=M("Sign up"),ai={class:"main-container login-container"},ni=o("p",null,"Log in to Mello",-1),ii=o("button",{class:"login"},"Log in",-1),li=M("Sign up for an account");function di(t,e,r,d,a,s){const n=p("router-link");return i(),l("div",Xn,[o("section",Qn,[ei,o("nav",ti,[m(n,{to:"/",class:"login"},{default:y(()=>[si]),_:1}),ri,m(n,{to:"/signup",class:"signup"},{default:y(()=>[oi]),_:1})])]),o("div",ai,[ni,o("form",{onSubmit:e[2]||(e[2]=S((...c)=>s.login&&s.login(...c),["prevent"]))},[T(o("input",{type:"text",name:"username","onUpdate:modelValue":e[0]||(e[0]=c=>a.user.username=c),placeholder:"Enter username",required:""},null,512),[[O,a.user.username]]),T(o("input",{type:"password",name:"password","onUpdate:modelValue":e[1]||(e[1]=c=>a.user.password=c),placeholder:"Enter password",required:""},null,512),[[O,a.user.password]]),ii],32),m(n,{class:"btn-signup",to:"/signup"},{default:y(()=>[li]),_:1})])])}var ci=_(Kn,[["render",di]]);const ui={data(){return{user:{fullname:null,username:null,email:null,password:null,imgUrl:"",mentions:[]},isLoading:!1,isLoaded:!1}},methods:{async onUploadImg(t){try{this.isLoading=!0;const e=await uploadImg(t);this.user.imgUrl=e.url,this.isLoaded=!0}catch(e){throw console.log("cannot upload image",e),e}finally{this.isLoading=!1}},async signup(){console.log(this.user),await this.$store.dispatch({type:"signup",userCred:this.user}),await this.$store.dispatch({type:"login",userCred:this.user})&&this.$router.push("/board")}}},hi={class:"login-signup"},mi={class:"header-home"},pi=o("div",{class:"logo"},[o("span",{class:"material-icons-outlined logo-icon"}),M("Mello ")],-1),gi={class:"homepage-nav"},ki=M("Home"),_i=o("span",null," | ",-1),bi=M("Log in"),fi={class:"main-container"},yi=o("p",null,"Sign up for your account",-1),vi={key:0},Ci=o("button",null,"Sign up",-1),Ti=M("Already have an account? Log in");function Si(t,e,r,d,a,s){const n=p("router-link");return i(),l("div",hi,[o("section",mi,[pi,o("nav",gi,[m(n,{to:"/",class:"login"},{default:y(()=>[ki]),_:1}),_i,m(n,{to:"/login",class:"signup"},{default:y(()=>[bi]),_:1})])]),o("div",fi,[yi,o("form",{onSubmit:e[4]||(e[4]=S((...c)=>s.signup&&s.signup(...c),["prevent"]))},[T(o("input",{type:"text",name:"fullname","onUpdate:modelValue":e[0]||(e[0]=c=>a.user.fullname=c),placeholder:"Enter full name",autocomplete:"off",required:""},null,512),[[O,a.user.fullname]]),T(o("input",{type:"text",name:"username","onUpdate:modelValue":e[1]||(e[1]=c=>a.user.username=c),placeholder:"Enter username",autocomplete:"off",required:""},null,512),[[O,a.user.username]]),T(o("input",{type:"email",name:"email","onUpdate:modelValue":e[2]||(e[2]=c=>a.user.email=c),placeholder:"Enter email",required:""},null,512),[[O,a.user.email]]),T(o("input",{type:"password",name:"password","onUpdate:modelValue":e[3]||(e[3]=c=>a.user.password=c),placeholder:"Enter password",required:""},null,512),[[O,a.user.password]]),o("div",null,[a.isLoading?(i(),l("div",vi," Loading image... ")):h("",!0)]),Ci],32),m(n,{class:"btn-signup",to:"/login"},{default:y(()=>[Ti]),_:1})])])}var Ei=_(ui,[["render",Si]]);const he=Se({history:Ee("/"),routes:[{path:"/",name:"home",component:rt},{path:"/board",name:"boards",component:ft},{path:"/board/:boardId",name:"board",component:nr,children:[{path:"task/:groupId/:taskId",name:"task-details",component:Yn}]},{path:"/login",name:"Login",component:ci},{path:"/signup",name:"Signup",component:Ei}]}),Mi="/api/";var Bi=de.create({withCredentials:!0});const L={get(t,e){return F(t,"GET",e)},post(t,e){return F(t,"POST",e)},put(t,e){return F(t,"PUT",e)},delete(t,e){return F(t,"DELETE",e)}};async function F(t,e="GET",r=null){try{return(await Bi({url:`${Mi}${t}`,method:e,data:r,params:e==="GET"?r:null})).data}catch(d){throw console.log(`Had Issues ${e}ing to the backend, endpoint: ${t}, with data:`,r),console.dir(d),d.response&&d.response.status===401&&he.push("/login"),d}}const wi="user-watch",ae="board updated",ne="user-updated",$i="",U=Oi();window.socketService=U;U.setup();function Oi(){var t=null;return{async setup(){t=Me($i),console.log("socket",t)},on(r,d){t.on(r,d)},off(r,d=null){!t||(d?t.off(r,d):t.removeAllListeners(r))},emit(r,d){t.emit(r,d)},terminate(){t=null}}}const K="loggedinUser",E={login:ge,logout:Ai,signup:Ii,getLoggedinUser:Q,getUsers:xi,getById:me,remove:Di,update:pe,changeScore:Li,getMiniUser:Ni,guest:Ui};window.userService=E;function xi(){return L.get("user")}async function me(t){return await L.get(`user/${t}`)}function Di(t){return L.delete(`user/${t}`)}async function pe(t){return t=await L.put(`user/${t._id}`,t),Q()._id===t._id&&X(t),t}async function ge(t){try{const e=await L.post("auth/login",t);if(e)return X(e)}catch(e){throw console.log("userService: Error in login user",e),e}}async function Ii(t){try{console.log(t);const e=await L.post("auth/signup",t);return X(e)}catch(e){throw console.log("userService: Error in signup user",e),e}}async function Ai(){return sessionStorage.removeItem(K),await L.post("auth/logout")}async function Li(t){const e=Q();if(!e)throw new Error("Not loggedin");return e.score=e.score+t||t,await pe(e),e.score}async function Ui(){return await ge({username:"amit",password:"123"})}function X(t){return sessionStorage.setItem(K,JSON.stringify(t)),t}function Q(){const t=JSON.parse(sessionStorage.getItem(K)||"null");if(!!t)return delete t.password,t}async function Ni(t){try{const e=await me(t);return{_id:e._id,username:e.username,fullname:e.fullname,imgUrl:e.imgUrl,color:e.color}}catch(e){throw console.log("userService: Error in getById user",e),e}}const I={query:Gi,getById:Ji,remove:ji,save:zi,getEmptyBoard:Fi,getEmptyTask:Pi,getEmptyGroup:qi};async function Gi(){try{return await L.get("board")}catch(t){console.log("query had an error",t)}}async function Ji(t){try{return await L.get(`board/${t}`)}catch(e){console.log("Error:",e)}}async function ji(t){try{return await L.get(`board/${t}`)}catch(e){console.log("Error:",e)}}async function zi(t){try{return t._id?await L.put("board",t):await L.post("board",t)}catch(e){console.log("Error:",e)}}async function Fi(){return{title:"",createdAt:Date.now(),createdBy:{},style:{bgImg:["https://res.cloudinary.com/dxj8szufc/image/upload/v1648812004/bg/bg6_hsbmsz.jpg","https://res.cloudinary.com/dxj8szufc/image/upload/v1648812001/bg/bg2_mz8ugr.jpg","https://res.cloudinary.com/dxj8szufc/image/upload/v1648812000/bg/bg3_dmcjgv.jpg","https://res.cloudinary.com/dxj8szufc/image/upload/v1648811997/bg/bg5_pkzq9o.jpg","https://res.cloudinary.com/dxj8szufc/image/upload/v1648811995/bg/bg4_mvddif.jpg","https://res.cloudinary.com/dxj8szufc/image/upload/v1648811991/bg/bg7_tbhddd.jpg","https://res.cloudinary.com/dxj8szufc/image/upload/v1648811988/bg/bg_iyfy8d.jpg","https://res.cloudinary.com/dxj8szufc/image/upload/v1648811985/bg/bg1_xzp635.jpg","#0079bf","#d29034","#519839","#b04632","#89609e","#cd5a91","#4bbf6b","#00aecc"]},labels:[{id:"l101",title:"",color:"#61bd4f"},{id:"l102",title:"",color:"#f2d600"},{id:"l103",title:"",color:"#ff9f1a"},{id:"l104",title:"",color:"#eb5a46"},{id:"l105",title:"",color:"#c377e0"},{id:"l106",title:"",color:"#0079bf"},{id:"l107",title:"",color:"#00c2e0"},{id:"l108",title:"",color:"#51e898"},{id:"l109",title:"",color:"#ff78cb"},{id:"l110",title:"",color:"#344563"}],members:[],groups:[],activities:[]}}function qi(){return{id:"",title:"",tasks:[],style:{}}}function Pi(){const{_id:t,fullname:e,imgUrl:r}=E.getLoggedinUser();return{id:x.makeId(),title:"",status:"",description:"",createdAt:Date.now(),dueDate:null,byMember:{_id:t,fullname:e,imgUrl:r}}}const Vi={data(){return{board:I.getEmptyBoard(),colors:[],imgs:[],selectImg:"",selectColor:""}},created(){this.renderColors()},methods:{renderColors(){this.colors=[];for(var t=0;t<9;t++)this.colors.push(x.getRandomColor())},closeCompose(t){t.target.className==="board-compose-container"&&this.$emit("closeCompose")},async createBoard(){this.board.style={"background-color":this.selectColor,"background-image":`url(${this.selectImg})`},this.board.createdAt=Date.now();try{const t=this.$store.getters.loggedinUser._id,e=await this.$store.dispatch({type:"getMiniUser",userId:t});this.board.createdBy=e,this.board.members=[e],this.$emit("addBoard",this.board)}catch(t){console.log("failed to get miniLoggedInUser",t)}},close(){this.$emit("closeCompose")},setBcg(t){this.selectImg="",this.selectColor=t,this.board.style={"background-color":t}},setimg(t){this.selectColor="",this.selectImg=t,this.board.style={"background-image:":`url(${t})`}}},destroyed(){this.colors=[]}},Ri={class:"board-compose"},Hi=M("Create board"),Wi=M("Change Colors"),Zi={class:"backgrounds"},Yi={class:"board-compose-imgs"},Ki=["onClick"],Xi={class:"board-compose-bgcs"},Qi=["onClick"];function el(t,e,r,d,a,s){const n=p("el-input"),c=p("el-button");return i(),l("div",{class:"board-compose-container",onClick:e[2]||(e[2]=(...u)=>s.closeCompose&&s.closeCompose(...u))},[o("div",Ri,[o("div",{class:"board-compose-preview",style:f({backgroundColor:a.selectColor,backgroundImage:`url(${a.selectImg})`})},[o("span",{onClick:e[0]||(e[0]=(...u)=>s.close&&s.close(...u))},"close"),m(n,{placeholder:"Add board title",modelValue:a.board.title,"onUpdate:modelValue":e[1]||(e[1]=u=>a.board.title=u),onKeyup:R(s.createBoard,["enter","native"])},null,8,["modelValue","onKeyup"]),m(c,{onClick:s.createBoard,type:"primary",disabled:!a.board.title,class:"compose-btn"},{default:y(()=>[Hi]),_:1},8,["onClick","disabled"]),m(c,{onClick:s.renderColors,type:"primary",class:"compose-btn change-colors"},{default:y(()=>[Wi]),_:1},8,["onClick"])],4),o("section",Zi,[o("div",Yi,[(i(!0),l(v,null,C(a.imgs,(u,b)=>(i(),l("span",{key:b,style:f({backgroundImage:`url(${u})`}),onClick:A=>s.setimg(u)},null,12,Ki))),128))]),o("div",Xi,[(i(!0),l(v,null,C(a.colors,(u,b)=>(i(),l("span",{key:b,style:f({backgroundColor:u}),onClick:A=>s.setBcg(u)},null,12,Qi))),128))])])])])}var tl=_(Vi,[["render",el]]);const sl={props:{boards:{type:Array,required:!0}},data(){return{recentBoards:null,listClose:[],searchBoard:""}},created(){this.$store.getters.currBoard&&this.$store.commit({type:"addBoardToRecentBoards",board:this.$store.getters.currBoard}),this.recentBoards=this.$store.getters.recentBoards},mounted(){this.$refs.searchBoard.focus()},methods:{closeBoardList(){this.$emit("closeBoardList")},openBoard(t){this.$store.commit({type:"addBoardToRecentBoards",board:t}),(!this.$store.getters.currBoard||t._id!==this.$store.getters.currBoard._id)&&(this.$emit("setBackground",t.style),this.$store.commit({type:"setCurrBoard",board:t}),this.$router.push(`/b/${t._id}`)),this.closeBoardList()},toggleListClose(t){const e=this.listClose.findIndex(r=>r===t);e===-1?this.listClose.push(t):this.listClose.splice(e,1)},setFilter(){this.$store.commit({type:"setFilterBy",filterBy:{txt:this.searchBoard}})}},computed:{borads(){return this.boards.filter(t=>t.isStarred)},boardsAfterFilter(){return this.$store.getters.boardsToShow}}},rl={key:0},ol={key:0},al=o("h2",{class:"title"},[o("span",null,"BOARDS")],-1),nl={key:0},il=["onClick"],ll=o("h2",null,[o("span",null,"RECENT BOARDS")],-1),dl={key:0},cl=["onClick"],ul=o("h2",null,[o("span",null,"ALL BOARDS")],-1),hl={key:0},ml=["onClick"],pl={key:1},gl=["onClick"];function kl(t,e,r,d,a,s){return i(),l("section",null,[o("header",null,[T(o("input",{ref:"searchBoard",class:"input-search-boards",type:"text",placeholder:"Find boards by name...","onUpdate:modelValue":e[0]||(e[0]=n=>a.searchBoard=n),onInput:e[1]||(e[1]=(...n)=>s.setFilter&&s.setFilter(...n))},null,544),[[O,a.searchBoard]]),o("span",{onClick:e[2]||(e[2]=(...n)=>s.closeBoardList&&s.closeBoardList(...n))},"close")]),o("main",null,[a.searchBoard?(i(),l("section",pl,[o("div",null,[(i(!0),l(v,null,C(s.boardsAfterFilter,n=>(i(),l("article",{key:n._id,class:"board-preview",onClick:c=>s.openBoard(n)},null,8,gl))),128))])])):(i(),l("section",rl,[s.borads.length?(i(),l("div",ol,[al,a.listClose.includes("borads")?h("",!0):(i(),l("div",nl,[(i(!0),l(v,null,C(s.borads,n=>(i(),l("article",{key:n._id,class:"board-preview",onClick:c=>s.openBoard(n)}," > ",8,il))),128))]))])):h("",!0),o("div",null,[ll,a.listClose.includes("recentBoards")?h("",!0):(i(),l("div",dl,[(i(!0),l(v,null,C(a.recentBoards,n=>(i(),l("article",{key:n._id,onClick:c=>s.openBoard(n)},null,8,cl))),128))]))]),o("div",null,[ul,a.listClose.includes("boards")?h("",!0):(i(),l("div",hl,[(i(!0),l(v,null,C(r.boards,n=>(i(),l("article",{key:n._id,class:"board-preview",onClick:c=>s.openBoard(n)},null,8,ml))),128))]))])]))])])}var _l=_(sl,[["render",kl]]);const bl={props:{user:{type:Object,required:!0}},data(){return{}},methods:{close(){this.$emit("close")},logout(){this.$emit("logout")}},components:{userAvatar:G}},fl={class:"user-menu"},yl={class:"group-edit-header"},vl=o("span",null,"Account",-1),Cl={class:"account-info"},Tl={class:"account-details"},Sl={class:"username"};function El(t,e,r,d,a,s){const n=p("user-avatar");return i(),l("section",fl,[o("div",yl,[vl,o("span",{onClick:e[0]||(e[0]=S((...c)=>s.close&&s.close(...c),["stop"])),class:"close"},"X")]),o("div",Cl,[m(n,{size:32,username:r.user.fullname,src:r.user.imgUrl,backgroundColor:"#DFE1E6",color:"#172b4d"},null,8,["username","src"]),o("div",Tl,[o("span",null,k(r.user.fullname),1),o("span",Sl," ( "+k(r.user.username)+" )",1)])]),o("div",{class:"logout",onClick:e[1]||(e[1]=(...c)=>s.logout&&s.logout(...c))},"Log out")])}var Ml=_(bl,[["render",El]]),Bl="/assets/boardAdd.ea732269.svg";const wl={props:{menuOpen:Boolean},data(){return{boardToAdd:null,boardBg:"#0079bf"}},components:{customMenu:q},async created(){const t=await this.$store.dispatch({type:"getEmptyBoard"});this.boardToAdd=t},mounted(){},methods:{setBg(t){this.boardBg=t,console.log(t),console.log(this.$refs);for(const e in this.$refs)this.boardBg===e?e.split("")[0]==="#"?this.$refs[e][0].classList.value="bg-opt clr checked":this.$refs[e][0].classList.value="bg-opt checked":e.split("")[0]==="#"?this.$refs[e][0].classList.value="bg-opt clr":this.$refs[e][0].classList.value="bg-opt"},closeMenu(){this.$emit("closeMenu")},getStyle(t){return`background-color: ${t}`},getClass(){this.$refs.title.value?this.$refs.btn.classList.value="enable":this.$refs.btn.classList.value="disable"},async saveBoard(){if(!this.$refs.title.value)return;this.boardToAdd.title=this.$refs.title.value,this.boardToAdd.style.bg=this.boardBg;const t=this.$store.getters.loggedinUser;this.boardToAdd.createdBy={_id:t._id,fullname:t.fullname,imgUrl:"http://some-img"},this.boardToAdd.members.unshift(t),delete this.boardToAdd.style.bgImg;const e=await this.$store.dispatch({type:"saveCurrBoard",boardToSave:this.boardToAdd});this.boardToAdd=await this.$store.dispatch({type:"getEmptyBoard"}),this.$emit("closeMenu"),this.$router.push(`/board/${e._id}`)}},computed:{getBg(){if(this.boardBg)return this.boardBg.split("")[0]==="#"?`background-color: ${this.boardBg}`:`background-image: url(${this.boardBg})`}}},$l={class:"board-add-menu"},Ol=o("p",null,"Create board",-1),xl=o("hr",null,null,-1),Dl={class:"board-add-container flex align-center column"},Il=o("img",{class:"board-image",src:Bl,alt:""},null,-1),Al=[Il],Ll={class:"bg-selector"},Ul=o("p",null,"Background",-1),Nl={class:"btn-bg-container flex wrap"},Gl=["onClick","idx"],Jl=["src"],jl=o("p",null,[M("Board title "),o("span",null,"*")],-1),zl=o("div",{class:"emoticon"},"\u{1F44B} Board title is required",-1);function Fl(t,e,r,d,a,s){const n=p("custom-menu"),c=J("focus");return i(),l("section",$l,[m(n,{menuOpen:r.menuOpen},{default:y(()=>[Ol,o("button",{onClick:e[0]||(e[0]=(...u)=>s.closeMenu&&s.closeMenu(...u)),class:"close",title:"Close"}),xl,o("section",Dl,[o("div",{style:f(s.getBg),class:"board-image-container flex center align-center"},Al,4),o("div",Ll,[Ul,o("div",Nl,[(i(!0),l(v,null,C(a.boardToAdd.style.bgImg,(u,b)=>(i(),l("label",{key:b,onClick:S(A=>s.setBg(u),["stop"]),idx:b},[u.split("")[0]!=="#"?(i(),l("img",{key:0,class:"bg-opt",src:u,alt:"",ref_for:!0,ref:u},null,8,Jl)):h("",!0),u.split("")[0]=="#"?(i(),l("div",{key:1,style:f(s.getStyle(u)),class:"bg-opt clr",ref_for:!0,ref:u},null,4)):h("",!0)],8,Gl))),128)),jl,o("form",{action:"submit",onSubmit:e[4]||(e[4]=S(()=>{},["prevent"]))},[T(o("input",{required:"",ref:"title",onFocus:e[1]||(e[1]=(...u)=>s.getClass&&s.getClass(...u)),onInput:e[2]||(e[2]=(...u)=>s.getClass&&s.getClass(...u)),placeholder:"   ",type:"text"},null,544),[[c]]),zl,o("button",{ref:"btn",type:"submit",onClick:e[3]||(e[3]=(...u)=>s.saveBoard&&s.saveBoard(...u))},"Create",512)],32)])])])]),_:1},8,["menuOpen"])])}var ie=_(wl,[["render",Fl]]),ql="/assets/boards.b440fffa.png",Pl="data:image/gif;base64,R0lGODlhOAFAAHAAACH5BAEAAAIALAAAAAA4AUAAgQAAAP///wAAAAAAAAL/lB+py+0P3Zm02ouz3rz7D2KR0o1BiKaIybbuqcbyTNceW472Pr3+L+EJh8QijmMq0oDMpvIJjSKT04gU1cwCr9yu8riheqvasljY4rnGKbDmzBaZ51a0r/aLf9wZuL5CFxi0szVT+Bfmd6GIaCD4SEJ4GDPZuMgIqGOZCSmoxmSYtymnmVg3utIZ+FkZAopqwUcKAZuqOscqqvJa24NJ8fsXbNuQc4rntNtaK3t5jFpKtrD3HMrret0r0BwbDV3dNyhdLJlNvQzLzUnb6/0mbvqQix5/p00sP07ODD47fdNPWTIQWYZEWjLMkTtkCQTmM8bg3EOG5vStsbYQYMZ1/xNlXLR40KJEeBgrvjMJ8SPBhNs2arR3smPMfyn3UUTpTAJLjrpesqtHciQ9hT9F+rSJsKDQaTt9aVnp0mlRqE/9IZ0ZEmjEcrR26mhK1MzRoN0CYq3Kc2vNhmNp3tQZVSpcs2XprL2aUyZIpcDo9sVrVe3bYl7ZNe20N2tgwXfF/tW7eKnbpIbjtqzsF59drYDTMuaM6zHZvIrDTS0ZJKEmlrdgmM58+fRrxHI71518FrfH1ZZPqX6hWbZoyJ51L/YUvHTktsodPgxW6je3NLOJD7d9HVLtz9XZNvY+WC1033GpHzeeHH129euDAg87+nZz+dwpRY96bJi67fXTz6rnz55/6n1kWXCS/YdNfhtFM16B++0HIILwCRfhVgVOCB5oGaJmEybPNAjbg6w5OCIVF8bWX3sb7qZgQB/id6GIJGZmnoaRnNjaPPAo4s0vEFa4ooCu5RYgitYV9w+Ot+iIFI+n+aikSz9imKKQVOUTJW02wCFLNVDCZmR8YWInYGJDfkdCltpxJROXXko5I4xxHkllkSo2pOYjTH7mpl5fZtQTfWTWKSFYY/9GlCdyWy50Bjh/5kiknfoZikOiq7Dp3n2yPbpkpBIeiuCUd55g6WaLOqopWZxq2d2goAYJ5Jlmkgrmq2XsaZyJwq2qqI2w3umrrMG+emBop+76VT+8mjormsIi+Stpc9EZK1/h5ZosccuiVeyn0lF4Xpq1Qnqstla4COeL1HoabZm+JnjuuJ2WO5q1wIb7rEElgmtltzDsyypl5g617accuvotv6MS2hpM186HU8HtPuxtb6La+m/DjtFrW8Ry1urcugCLfITGG1OcL8bYgQgyFiOLyXCoYJh8K6YrOywoeyqtFGzKQvqscsoE0mzvwTrjDC3Q76XUM3qBVrvi0kS2F82iwkvj2zSffqHz9M81xzy1wlfCfLW0VYLNrdmAIg21tWHj5PLWO+dcKLn4qsq21wOh/fbZYw9aI9azUp10Z3nr/XTfXdtH45SFBaw2hYcjXnbQik/s7+Bm+rt3q+BWTnfnlIdtR4hzwjzqUG0LPXfk9FweuMCo2+osvMyye/TFxt6tuL7yzk573LtrjjvQqYvNN833LE9r2sxJeuLoy09PvbN+j9WGq64bXH333n//BOYWFAAAOw==";const Vl={data(){return{boardMenuOpen:!1,user:null,bg:""}},components:{userAvatar:G,boardCompose:tl,boardList:_l,userMenu:Ml,boardAddMenu:ie,BoardAddMenu:ie},created(){},methods:{toggleBoardCompose(){this.isBoardComposeOn=!this.isBoardComposeOn},toggleBoardList(){this.isBoardListOpen=!this.isBoardListOpen},hideBoardList(){this.isBoardListOpen=!1},hideUserMenu(){this.isUserMenuOpen=!1},addBoard(t){this.$emit("addBoard",t),this.isBoardComposeOn=!1},setBackground(t){this.$emit("setBackground",t)},async logout(){await this.$store.dispatch({type:"logout"});const t={"background-color":"whitesmoke"};this.setBackground(t),this.$router.push("/")}},computed:{boards(){return this.$store.getters.boards},getClr(){}},watch:{"$route.params"(t){t.boardId?(this.user=E.getLoggedinUser(),this.bg="#00000040"):this.bg="#026AA7"}}},Rl=o("button",{class:"btn-boards",title:"Boards"},[o("img",{src:ql,alt:""})],-1),Hl=o("button",{title:"Mello",class:"btn-logo"},[o("img",{src:Pl,alt:""})],-1);function Wl(t,e,r,d,a,s){const n=p("router-link"),c=p("board-add-menu"),u=p("user-avatar");return i(),l("section",{style:f({"background-color":`${a.bg}`}),class:"main-header"},[m(n,{to:"/board"},{default:y(()=>[Rl]),_:1}),m(n,{to:"/"},{default:y(()=>[Hl]),_:1}),o("button",{onClick:e[0]||(e[0]=b=>a.boardMenuOpen=!a.boardMenuOpen),class:"btn-opt create",title:"Create"},"Create"),m(c,{onCloseMenu:e[1]||(e[1]=b=>a.boardMenuOpen=!1),menuOpen:a.boardMenuOpen},null,8,["menuOpen"]),a.user?(i(),$(u,{key:0,diameter:32,user:a.user},null,8,["user"])):h("",!0)],4)}var Zl=_(Vl,[["render",Wl]]);const Yl={name:"app-vue",computed:{editModalStatus(){return this.$store.getters.editModalStatus}},components:{mainHeader:Zl}};function Kl(t,e,r,d,a,s){const n=p("main-header"),c=p("router-view");return i(),l("section",null,[m(n),m(c)])}var Xl=_(Yl,[["render",Kl]]);const Ql={state:{loggedinUser:E.getLoggedinUser(),users:[],watchedUser:null},getters:{users({users:t}){return JSON.parse(JSON.stringify(t))},loggedinUser({loggedinUser:t}){return t},getMyMiniUser(t){const e=JSON.parse(JSON.stringify(t.loggedinUser));return delete e.email,delete e.mentions,e},watchedUser({watchedUser:t}){return t}},mutations:{setLoggedinUser(t,{user:e}){t.loggedinUser=e?re({},e):null},setWatchedUser(t,{user:e}){t.watchedUser=e},setUsers(t,{users:e}){t.users=e},removeUser(t,{userId:e}){t.users=t.users.filter(r=>r._id!==e)},setUserScore(t,{score:e}){t.loggedinUser.score=e},updateUser(t,{user:e}){const r=t.users.findIndex(d=>d._id===e._id);t.users.splice(r,1,e)}},actions:{async login({commit:t},{userCred:e}){try{const r=await E.login(e);return t({type:"setLoggedinUser",user:r}),r}catch(r){throw console.log("userStore: Error in login",r),r}},async signup({commit:t},{userCred:e}){try{const r=await E.signup(e);return t({type:"setLoggedinUser",user:r}),r}catch(r){throw console.log("userStore: Error in signup",r),r}},async logout({commit:t}){try{await E.logout(),t({type:"setLoggedinUser",user:null})}catch(e){throw console.log("userStore: Error in logout",e),e}},async loadUsers({commit:t}){try{const e=await E.getUsers();t({type:"setUsers",users:e})}catch(e){throw console.log("userStore: Error in loadUsers",e),e}},async loadAndWatchUser({commit:t},{userId:e}){try{const r=await E.getById(e);t({type:"setWatchedUser",user:r}),U.emit(wi,e),U.off(ne),U.on(ne,d=>{t({type:"setWatchedUser",user:d})})}catch(r){throw console.log("userStore: Error in loadAndWatchUser",r),r}},async removeUser({commit:t},{userId:e}){try{await E.remove(e),t({type:"removeUser",userId:e})}catch(r){throw console.log("userStore: Error in removeUser",r),r}},async updateUser({commit:t},{user:e}){try{e=await E.update(e),t({type:"setUser",user:e})}catch(r){throw console.log("userStore: Error in updateUser",r),r}},async increaseScore({commit:t}){try{const e=await E.changeScore(100);t({type:"setUserScore",score:e})}catch(e){throw console.log("userStore: Error in increaseScore",e),e}},async signup({commit:t},{userCred:e}){try{const r=await E.signup(e);return t({type:"setLoggedinUser",user:r}),r}catch(r){throw console.log("userStore: Error in signup",r),r}},async signupAsGuest({commit:t,dispatch:e}){try{const r=await E.signupAsGuest();await e({type:"loadAndWatchUser",userId:r._id}),t({type:"setLoggedinUser",user:r})}catch(r){throw console.log("userStore: Error in signup As Guest",r),r}},async getMiniUser(t,{userId:e}){try{return await E.getMiniUser(e)}catch(r){throw console.log("userStore: Error in getById user",r),r}}}},ed={state:{boards:[],currBoard:null,recentBoards:[],currTaskIdxs:null},getters:{boards(t){return JSON.parse(JSON.stringify(t.boards))},starBoards(t){return JSON.parse(JSON.stringify(t.boards.filter(e=>e.star)))},currBoard(t){return JSON.parse(JSON.stringify(t.currBoard))},currBoardLabels(t){return t.currBoard.labels},currBoardMembers(t){return t.currBoard.members},currBoardChecklists(t){const e=[];return t.currBoard.groups.forEach(r=>{r.tasks.forEach(d=>{!d.checklists||!d.checklists.length||e.push({taskId:d.id,taskTitle:d.title,checklists:d.checklists})})}),e},getCurrTask({currTaskIdxs:t,currBoard:e}){if(!t)return null;const{groupIdx:r,currTaskIdx:d}=t,a=e.groups[r].tasks[d];return JSON.parse(JSON.stringify(a))},recentBoards({recentBoards:t}){return t},cardEdit({cardEdit:t}){return t},boardsToShow(t){let e=new RegExp(t.filterBy.txt,"i");return t.boards.filter(r=>e.test(r.title))}},mutations:{setCurrTask(t,{currTaskIdx:e,groupIdx:r}){t.currTaskIdxs={currTaskIdx:e,groupIdx:r}},setCurrBoard(t,{currBoard:e}){t.currBoard=e},addBoardToRecentBoards(t,{board:e}){t.recentBoards.length>=5&&t.recentBoards.pop(),t.recentBoards=t.recentBoards.filter(r=>r._id!==e._id),t.recentBoards.unshift(e)},addBoard(t,{savedBoard:e}){t.boards.push(e)},loadBoards(t,{boards:e}){console.log(e),t.boards=e}},actions:{async loadCurrBoard(t,{boardId:e}){try{const r=await I.getById(e);return t.commit({type:"setCurrBoard",currBoard:r}),U.emit("watch board",r._id),U.off(ae),U.on(ae,d=>{console.log("board updated",d),t.commit({type:"setCurrBoard",currBoard:d})}),JSON.parse(JSON.stringify(r))}catch(r){console.error("Cannot load currBoard: ",r),t.dispatch({type:"flashUserMsg",msg:"Oops! Cannot load selected board...",style:"warning"})}finally{t.commit({type:"setIsLoading",loadingStatus:!1})}},async saveCurrBoard(t,{boardToSave:e}){const r=t.getters.currBoard;try{t.commit({type:"setCurrBoard",currBoard:e});const d=await I.save(e);return U.emit("board update",e),t.dispatch({type:"flashUserMsg",msg:`Board ${d._id} saved successfully`,style:"success"}),d}catch(d){t.commit({type:"setCurrBoard",currBoard:r}),console.error(`Cannot save board ${t.getters.currBoard._id}: `,d),t.dispatch({type:"flashUserMsg",msg:`Oops! Cannot save board ${t.getters.currBoard._id}...`,style:"warning"})}finally{t.commit({type:"setIsLoading",loadingStatus:!1})}},async updateGroup(t,{groupToSave:e}){console.log(e),t.commit({type:"setIsLoading",loadingStatus:!0});try{const r=t.getters.currBoard;if(e.id){const a=r.groups.findIndex(s=>s.id===e.id);r.groups.splice(a,1,e)}else e.id=x.makeId(),r.groups.push(e);const d=await t.dispatch({type:"saveCurrBoard",boardToSave:r});return U.emit("board update",r),d}catch(r){console.error(`Cannot save group ${t.getters.currBoard._Id}: `,r),t.dispatch({type:"flashUserMsg",msg:`Oops! Cannot save board ${t.getters.currBoard._id}...`,style:"warning"})}finally{t.commit({type:"setIsLoading",loadingStatus:!1})}},async copyGroup(t,{groupToSave:e}){t.commit({type:"setIsLoading",loadingStatus:!0});try{e.id=x.makeId();const r=t.getters.currBoard;return r.groups.push(e),await t.dispatch({type:"saveCurrBoard",boardToSave:r})}catch(r){console.error(`Cannot save group ${t.getters.currBoard._Id}: `,r),t.dispatch({type:"flashUserMsg",msg:`Oops! Cannot save board ${t.getters.currBoard._Id}...`,style:"warning"})}finally{t.commit({type:"setIsLoading",loadingStatus:!1})}},async getEmptyBoard(t){t.commit({type:"setIsLoading",loadingStatus:!0});try{return I.getEmptyBoard()}catch{console.error("Cannot get empty board: ",err),t.dispatch({type:"flashUserMsg",msg:"Oops! Cannot initiate a new board...",style:"warning"})}finally{t.commit({type:"setIsLoading",loadingStatus:!1})}},async loadCurrTask({commit:t,getters:e},{groupId:r,taskId:d}){const a=e.currBoard,s=a.groups.findIndex(c=>c.id===r),n=a.groups[s].tasks.findIndex(c=>c.id===d);t({type:"setCurrTask",groupIdx:s,currTaskIdx:n})},async getTaskById({getters:t},{groupId:e,taskId:r}){return t.currBoard.groups.find(n=>n.id===e).tasks.find(n=>n.id===r)},async saveTask(t,{groupId:e,taskToSave:r}){const d=t.getters.currBoard,a=d.groups.find(s=>s.id===e);if(r.id){const s=a.tasks.findIndex(n=>n.id===r.id);a.tasks[s]=r}else{debugger;r.id=x.makeId(),r.createdAt=Date.now(),console.log(a),a.tasks.push(r),console.log(a)}return t.dispatch({type:"saveCurrBoard",boardToSave:d})},async removeTask(t,{groupId:e,taskId:r}){const d=t.getters.currBoard,a=d.groups.find(n=>n.id===e),s=a.tasks.findIndex(n=>n.id===r);return a.tasks.splice(s,1),await t.dispatch({type:"saveCurrBoard",boardToSave:d})},async removeGroup(t,{group:e}){const r=t.getters.currBoard,d=r.groups.findIndex(s=>s.id===e.id);return r.groups.splice(d,1),await t.dispatch({type:"saveCurrBoard",boardToSave:r})},async getBoardById(t,{boardId:e}){try{return await I.getById(e)}catch(r){throw console.log("Cannot get board",e,",",r),r}},async loadBoards({commit:t}){try{var e=await I.query();const r=E.getLoggedinUser();return e=e.filter(d=>d.createdBy._id==r._id),t({type:"loadBoards",boards:e}),console.log(e),e}catch(r){throw console.log("Cannot load boards",r),r}},async updateLabel(t,{label:e}){const r=t.getters.currBoard,d=r.labels.findIndex(a=>a.id===e.id);return r.labels[d]=e,await t.dispatch({type:"saveCurrBoard",boardToSave:r})}}},td=Be({strict:!0,state:{editModalStatus:{isOpen:!1,editType:"",currTask:null,parentGroupId:""},isLoading:!1,userMsg:{msg:"",style:"",isAlive:!1}},getters:{editModalStatus(t){return JSON.parse(JSON.stringify(t.editModalStatus))},isLoading(t){return JSON.parse(JSON.stringify(t.isLoading))},userMsg(t){return t.userMsg}},mutations:{toggleEditModal(t,{isOpen:e,editType:r,currTask:d,parentGroupId:a}){t.editModalStatus={isOpen:e,editType:r,currTask:d,parentGroupId:a}},setIsLoading(t,{loadingStatus:e}){t.isLoading=e},setUserMsg(t,{msg:e,style:r,isAlive:d}){t.userMsg={msg:e,style:r,isAlive:d}},setMsg(t,{msg:e}){t.userMsg=e}},actions:{flashUserMsg(t,{msg:e,style:r}){t.commit({type:"setUserMsg",msg:e,style:r,isAlive:!0}),setTimeout(()=>{t.commit({type:"setUserMsg",msg:"",style:"",isAlive:!1})},2e3)},async showMsg({state:t,commit:e},{msg:r}){try{t.setTimeId&&clearTimeout(t.setTimeId),e({type:"setMsg",msg:r}),r={txt:"",type:""},t.setTimeId=setTimeout(()=>{e({type:"setMsg",msg:r}),clearTimeout(t.setTimeId)},2500)}catch(d){console.log("ERROR: cannot get userMsg",d)}}},modules:{userStore:Ql,boardStore:ed}}),sd={mounted:t=>{t.focus()}},rd={mounted:(t,e,r)=>{t.clickOutsideEvent=function(a){const s=t.getBoundingClientRect();(a.clientX<s.x||a.clientX>s.x+s.width||a.clientY<s.y||a.clientY>s.y+s.height)&&!(t==a.target||t.contains(a.target))&&(console.log("clicked outside!",t),e.value(a))};const d=function(){document.body.removeEventListener("click",d),document.body.removeEventListener("touchstart",d),document.body.addEventListener("click",t.clickOutsideEvent),document.body.addEventListener("touchstart",t.clickOutsideEvent)};document.body.addEventListener("click",d),document.body.addEventListener("touchstart",d)},unmounted:function(t){document.body.removeEventListener("click",t.clickOutsideEvent),document.body.removeEventListener("touchstart",t.clickOutsideEvent)},stopProp(t){t.stopPropagation()}};const j=we(Xl);j.config.globalProperties.$filters={};j.directive("focus",sd);j.directive("clickoutside",rd);j.use(he);j.use(td);j.use($e);j.mount("#app");
